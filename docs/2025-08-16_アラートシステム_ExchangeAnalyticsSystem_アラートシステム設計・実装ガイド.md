# Exchange Analytics System - ã‚¢ãƒ©ãƒ¼ãƒˆã‚·ã‚¹ãƒ†ãƒ è¨­è¨ˆãƒ»å®Ÿè£…ã‚¬ã‚¤ãƒ‰

## ğŸ“‹ ç›®æ¬¡

1. [æ¦‚è¦](#æ¦‚è¦)
2. [ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£](#ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£)
3. [ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆ](#ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆ)
4. [è¨­å®šç®¡ç†](#è¨­å®šç®¡ç†)
5. [CLIæ©Ÿèƒ½](#cliæ©Ÿèƒ½)
6. [å®Ÿè£…è©³ç´°](#å®Ÿè£…è©³ç´°)
7. [æ‹¡å¼µãƒ»ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º](#æ‹¡å¼µã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º)
8. [é‹ç”¨ãƒ»ç›£è¦–](#é‹ç”¨ç›£è¦–)
9. [ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°](#ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°)
10. [ä»Šå¾Œã®æ‹¡å¼µè¨ˆç”»](#ä»Šå¾Œã®æ‹¡å¼µè¨ˆç”»)

---

## æ¦‚è¦

### ğŸ¯ ç›®çš„
Exchange Analytics Systemã®ã‚¢ãƒ©ãƒ¼ãƒˆã‚·ã‚¹ãƒ†ãƒ ã¯ã€ä»¥ä¸‹ã®æ©Ÿèƒ½ã‚’æä¾›ã—ã¾ã™ï¼š

- **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ç›£è¦–**: ã‚·ã‚¹ãƒ†ãƒ ãƒªã‚½ãƒ¼ã‚¹ã€API ã‚¨ãƒ©ãƒ¼ã€ãƒ‡ãƒ¼ã‚¿å–å¾—çŠ¶æ³ã®ç›£è¦–
- **ç‚ºæ›¿ãƒ¬ãƒ¼ãƒˆç›£è¦–**: è¨­å®šã•ã‚ŒãŸé–¾å€¤ã‚’è¶…ãˆãŸå ´åˆã®ã‚¢ãƒ©ãƒ¼ãƒˆ
- **ãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œå‡º**: ãƒ†ã‚¯ãƒ‹ã‚«ãƒ«åˆ†æã«ã‚ˆã‚‹ãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œå‡ºæ™‚ã®ã‚¢ãƒ©ãƒ¼ãƒˆ
- **é€šçŸ¥æ©Ÿèƒ½**: Discordãƒãƒ£ãƒ³ãƒãƒ«åˆ†é›¢ã«ã‚ˆã‚‹é©åˆ‡ãªé€šçŸ¥é…ä¿¡
- **ç®¡ç†æ©Ÿèƒ½**: ã‚¢ãƒ©ãƒ¼ãƒˆã®ç¢ºèªãƒ»è§£æ±ºãƒ»å±¥æ­´ç®¡ç†

### ğŸ”§ ä¸»è¦æ©Ÿèƒ½
- ã‚¢ãƒ©ãƒ¼ãƒˆã‚¿ã‚¤ãƒ—åˆ¥ã®Discordãƒãƒ£ãƒ³ãƒãƒ«åˆ†é›¢
- é‡è¦åº¦ãƒ¬ãƒ™ãƒ«ç®¡ç†ï¼ˆlow, medium, high, criticalï¼‰
- ã‚¢ãƒ©ãƒ¼ãƒˆçŠ¶æ…‹ç®¡ç†ï¼ˆactive, acknowledged, resolvedï¼‰
- è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚ˆã‚‹æŸ”è»Ÿãªã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º
- CLI ã«ã‚ˆã‚‹ç®¡ç†ãƒ»ç›£è¦–æ©Ÿèƒ½

---

## ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### ğŸ“Š å…¨ä½“æ§‹æˆå›³

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ç›£è¦–å¯¾è±¡      â”‚    â”‚   ã‚¢ãƒ©ãƒ¼ãƒˆ      â”‚    â”‚   é€šçŸ¥ã‚·ã‚¹ãƒ†ãƒ   â”‚
â”‚                 â”‚    â”‚   ã‚·ã‚¹ãƒ†ãƒ       â”‚    â”‚                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ ã‚·ã‚¹ãƒ†ãƒ       â”‚â”€â”€â”€â–¶â”‚ â€¢ ã‚¢ãƒ©ãƒ¼ãƒˆæ¤œå‡º  â”‚â”€â”€â”€â–¶â”‚ â€¢ Discord       â”‚
â”‚   ãƒªã‚½ãƒ¼ã‚¹      â”‚    â”‚ â€¢ é‡è¦åº¦åˆ¤å®š    â”‚    â”‚ â€¢ ãƒãƒ£ãƒ³ãƒãƒ«åˆ†é›¢â”‚
â”‚ â€¢ API ã‚¨ãƒ©ãƒ¼    â”‚    â”‚ â€¢ çŠ¶æ…‹ç®¡ç†      â”‚    â”‚ â€¢ Webhooké€ä¿¡   â”‚
â”‚ â€¢ ãƒ‡ãƒ¼ã‚¿å–å¾—    â”‚    â”‚ â€¢ å±¥æ­´ç®¡ç†      â”‚    â”‚                 â”‚
â”‚ â€¢ ç‚ºæ›¿ãƒ¬ãƒ¼ãƒˆ    â”‚    â”‚                 â”‚    â”‚                 â”‚
â”‚ â€¢ ãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œå‡º  â”‚    â”‚                 â”‚    â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                       â”‚                       â”‚
         â”‚                       â”‚                       â”‚
         â–¼                       â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   è¨­å®šç®¡ç†      â”‚    â”‚   ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹  â”‚    â”‚   CLIç®¡ç†       â”‚
â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ YAMLè¨­å®š      â”‚    â”‚ â€¢ PostgreSQL    â”‚    â”‚ â€¢ ã‚¢ãƒ©ãƒ¼ãƒˆè¡¨ç¤º  â”‚
â”‚ â€¢ ç’°å¢ƒå¤‰æ•°      â”‚    â”‚ â€¢ ã‚¢ãƒ©ãƒ¼ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«â”‚   â”‚ â€¢ è¨­å®šç®¡ç†      â”‚
â”‚ â€¢ å‹•çš„æ›´æ–°      â”‚    â”‚ â€¢ å±¥æ­´ç®¡ç†      â”‚    â”‚ â€¢ çŠ¶æ…‹å¤‰æ›´      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ—ï¸ ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆæ§‹æˆ

#### 1. ãƒ‡ãƒ¼ã‚¿å±¤
- **AlertModel**: ã‚¢ãƒ©ãƒ¼ãƒˆãƒ‡ãƒ¼ã‚¿ã®æ°¸ç¶šåŒ–
- **AlertRepositoryImpl**: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ“ä½œ
- **BaseModel**: å…±é€šãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ç®¡ç†

#### 2. ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯å±¤
- **AlertConfigManager**: è¨­å®šç®¡ç†
- **DiffDetectionService**: å·®åˆ†æ¤œå‡º
- **TechnicalIndicatorDiffCalculator**: ãƒ†ã‚¯ãƒ‹ã‚«ãƒ«æŒ‡æ¨™å·®åˆ†è¨ˆç®—

#### 3. ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³å±¤
- **CLI Commands**: ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³æ“ä½œ
- **Monitor Commands**: ç›£è¦–ãƒ»è¡¨ç¤ºæ©Ÿèƒ½
- **Alert Config Commands**: è¨­å®šç®¡ç†

#### 4. å¤–éƒ¨é€£æºå±¤
- **Discord Webhook**: é€šçŸ¥é…ä¿¡
- **Environment Variables**: è¨­å®šå€¤ç®¡ç†

---

## ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆ

### ğŸ“Š ãƒ†ãƒ¼ãƒ–ãƒ«æ§‹é€ 

#### alerts ãƒ†ãƒ¼ãƒ–ãƒ«

```sql
CREATE TABLE alerts (
    id SERIAL PRIMARY KEY,
    uuid VARCHAR(36) UNIQUE NOT NULL,
    alert_type VARCHAR(50) NOT NULL,
    severity VARCHAR(20) NOT NULL,
    status VARCHAR(20) NOT NULL DEFAULT 'active',
    currency_pair VARCHAR(10),
    message TEXT NOT NULL,
    details JSONB,
    acknowledged_at TIMESTAMP WITH TIME ZONE,
    resolved_at TIMESTAMP WITH TIME ZONE,
    acknowledged_by VARCHAR(100),
    resolved_by VARCHAR(100),
    related_data_id INTEGER,
    related_data_type VARCHAR(50),
    created_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT NOW(),
    updated_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT NOW(),
    version INTEGER NOT NULL DEFAULT 1
);
```

### ğŸ” ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹è¨­è¨ˆ

```sql
-- ã‚¢ãƒ©ãƒ¼ãƒˆã‚¿ã‚¤ãƒ—ã§ã®æ¤œç´¢
CREATE INDEX idx_alert_type ON alerts(alert_type);

-- é‡è¦åº¦ã§ã®æ¤œç´¢
CREATE INDEX idx_alert_severity ON alerts(severity);

-- ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã§ã®æ¤œç´¢
CREATE INDEX idx_alert_status ON alerts(status);

-- ä½œæˆæ™‚åˆ»ã§ã®æ¤œç´¢
CREATE INDEX idx_alert_created_at ON alerts(created_at);

-- é€šè²¨ãƒšã‚¢ã§ã®æ¤œç´¢
CREATE INDEX idx_alert_currency_pair ON alerts(currency_pair);

-- ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚¢ãƒ©ãƒ¼ãƒˆã®æ¤œç´¢
CREATE INDEX idx_alert_active ON alerts(status, created_at);
```

### ğŸ“ ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰è©³ç´°

| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å | å‹ | èª¬æ˜ | ä¾‹ |
|-------------|----|------|----|
| `id` | SERIAL | ä¸»ã‚­ãƒ¼ | 1, 2, 3... |
| `uuid` | VARCHAR(36) | ä¸€æ„è­˜åˆ¥å­ | "550e8400-e29b-41d4-a716-446655440000" |
| `alert_type` | VARCHAR(50) | ã‚¢ãƒ©ãƒ¼ãƒˆã‚¿ã‚¤ãƒ— | "system_resource", "rate_threshold" |
| `severity` | VARCHAR(20) | é‡è¦åº¦ | "low", "medium", "high", "critical" |
| `status` | VARCHAR(20) | ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ | "active", "acknowledged", "resolved" |
| `currency_pair` | VARCHAR(10) | é€šè²¨ãƒšã‚¢ | "USD/JPY", "EUR/USD" |
| `message` | TEXT | ã‚¢ãƒ©ãƒ¼ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ | "Memory usage exceeded threshold" |
| `details` | JSONB | è©³ç´°ãƒ‡ãƒ¼ã‚¿ | `{"resource": "memory", "usage": 85.2}` |
| `acknowledged_at` | TIMESTAMP | ç¢ºèªæ™‚åˆ» | 2025-08-16 17:30:00+09 |
| `resolved_at` | TIMESTAMP | è§£æ±ºæ™‚åˆ» | 2025-08-16 18:00:00+09 |
| `acknowledged_by` | VARCHAR(100) | ç¢ºèªè€… | "admin" |
| `resolved_by` | VARCHAR(100) | è§£æ±ºè€… | "admin" |
| `related_data_id` | INTEGER | é–¢é€£ãƒ‡ãƒ¼ã‚¿ID | 123 |
| `related_data_type` | VARCHAR(50) | é–¢é€£ãƒ‡ãƒ¼ã‚¿ã‚¿ã‚¤ãƒ— | "price_data" |
| `created_at` | TIMESTAMP | ä½œæˆæ™‚åˆ» | 2025-08-16 17:25:00+09 |
| `updated_at` | TIMESTAMP | æ›´æ–°æ™‚åˆ» | 2025-08-16 17:25:00+09 |
| `version` | INTEGER | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | 1 |

---

## è¨­å®šç®¡ç†

### ğŸ“ è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«æ§‹é€ 

#### config/alerts.yaml

```yaml
# ãƒ¬ãƒ¼ãƒˆé–¾å€¤ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®š
rate_threshold_alerts:
  enabled: true
  currency_pairs:
    USD/JPY:
      upper_threshold: 151.00
      lower_threshold: 140.00
      check_interval_minutes: 5
      severity: "high"
    EUR/USD:
      upper_threshold: 1.1500
      lower_threshold: 1.0500
      check_interval_minutes: 5
      severity: "medium"

# ãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œå‡ºã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®š
pattern_detection_alerts:
  enabled: true
  confidence_threshold: 0.80
  patterns:
    reversal:
      enabled: true
      severity: "high"
      min_confidence: 0.85
    continuation:
      enabled: true
      severity: "medium"
      min_confidence: 0.80
    divergence:
      enabled: true
      severity: "high"
      min_confidence: 0.90

# ã‚·ã‚¹ãƒ†ãƒ ãƒªã‚½ãƒ¼ã‚¹ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®š
system_resource_alerts:
  enabled: true
  cpu_usage:
    warning_threshold: 70
    critical_threshold: 90
    severity: "medium"
  memory_usage:
    warning_threshold: 80
    critical_threshold: 95
    severity: "high"
  disk_usage:
    warning_threshold: 85
    critical_threshold: 95
    severity: "medium"

# API ã‚¨ãƒ©ãƒ¼ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®š
api_error_alerts:
  enabled: true
  rate_limit_threshold: 5
  timeout_threshold: 3
  severity: "medium"

# ãƒ‡ãƒ¼ã‚¿å–å¾—ã‚¨ãƒ©ãƒ¼ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®š
data_fetch_alerts:
  enabled: true
  consecutive_failures: 3
  severity: "high"
  timeframes:
    - "5m"
    - "1h"
    - "4h"
    - "1d"

# é€šçŸ¥è¨­å®š
notification_settings:
  email:
    enabled: false
    recipients: []
  discord:
    enabled: true
    webhook_url: "${DISCORD_WEBHOOK_URL}"
    channel_id: "${DISCORD_CHANNEL_ID}"
    # ã‚¢ãƒ©ãƒ¼ãƒˆã‚¿ã‚¤ãƒ—åˆ¥ã®Webhook URLè¨­å®š
    alert_type_webhooks:
      # ã‚·ã‚¹ãƒ†ãƒ ç³»ã‚¢ãƒ©ãƒ¼ãƒˆï¼ˆãƒªã‚½ãƒ¼ã‚¹ç›£è¦–ã€API ã‚¨ãƒ©ãƒ¼ç­‰ï¼‰
      system_resource: "${DISCORD_MONITORING_WEBHOOK_URL}"
      api_error: "${DISCORD_MONITORING_WEBHOOK_URL}"
      data_fetch_error: "${DISCORD_MONITORING_WEBHOOK_URL}"
      # ç‚ºæ›¿ç³»ã‚¢ãƒ©ãƒ¼ãƒˆï¼ˆãƒ¬ãƒ¼ãƒˆé–¾å€¤ã€ãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œå‡ºç­‰ï¼‰
      rate_threshold: "${DISCORD_WEBHOOK_URL}"
      pattern_detection: "${DISCORD_WEBHOOK_URL}"
      # ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼ˆè¨­å®šã•ã‚Œã¦ã„ãªã„ã‚¢ãƒ©ãƒ¼ãƒˆã‚¿ã‚¤ãƒ—ç”¨ï¼‰
      default: "${DISCORD_WEBHOOK_URL}"
  slack:
    enabled: false
    webhook_url: ""

# ã‚¢ãƒ©ãƒ¼ãƒˆç®¡ç†è¨­å®š
alert_management:
  auto_resolve:
    enabled: true
    resolve_after_hours: 24
  escalation:
    enabled: true
    escalation_after_hours: 2
  retention:
    keep_resolved_days: 30
```

### ğŸ”§ ç’°å¢ƒå¤‰æ•°è¨­å®š

#### .env ãƒ•ã‚¡ã‚¤ãƒ«

```bash
# === é€šçŸ¥è¨­å®š ===
DISCORD_WEBHOOK_URL=https://canary.discord.com/api/webhooks/1403643478361116672/nf6aIMHvPjNVX4x10i_ARpbTa9V5_XAtGUenrbkauV1ibdDZbT9l5U7EoTreZ5LiwwKZ

DISCORD_MONITORING_WEBHOOK_URL=https://canary.discord.com/api/webhooks/1404124259520876595/NV4t96suXeoQN6fvOnpKRNpDdBVBESRvChWLp3cZ3TMWuWwJvYX9VfmDWEBzbI9DoX_d

# ã‚ªãƒ—ã‚·ãƒ§ãƒŠãƒ«
DISCORD_CHANNEL_ID=your_channel_id
```

### ğŸ›ï¸ è¨­å®šç®¡ç†ã‚¯ãƒ©ã‚¹

#### AlertConfigManager

```python
class AlertConfigManager:
    """ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®šç®¡ç†ã‚¯ãƒ©ã‚¹"""

    def __init__(self, config_path: Optional[str] = None):
        self.config_path = config_path or "config/alerts.yaml"
        self._config: Optional[AlertConfig] = None

        # .envãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã¿
        self._load_env_file()
        self._load_config()

    def get_discord_webhook_url(self, alert_type: str) -> Optional[str]:
        """ã‚¢ãƒ©ãƒ¼ãƒˆã‚¿ã‚¤ãƒ—åˆ¥ã®Discord Webhook URLã‚’å–å¾—"""

    def get_discord_channel_id(self) -> Optional[str]:
        """Discordãƒãƒ£ãƒ³ãƒãƒ«IDã‚’å–å¾—"""

    def is_alert_enabled(self, alert_type: str) -> bool:
        """ã‚¢ãƒ©ãƒ¼ãƒˆã‚¿ã‚¤ãƒ—ãŒæœ‰åŠ¹ã‹ã©ã†ã‹ã‚’åˆ¤å®š"""

    def get_threshold_config(self, alert_type: str, currency_pair: str = None) -> Dict:
        """é–¾å€¤è¨­å®šã‚’å–å¾—"""
```

---

## CLIæ©Ÿèƒ½

### ğŸ–¥ï¸ ã‚³ãƒãƒ³ãƒ‰ä¸€è¦§

#### 1. ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®šç®¡ç†

```bash
# è¨­å®šè¡¨ç¤º
exchange-analytics alert-config show

# è¨­å®šæ¤œè¨¼
exchange-analytics alert-config validate

# è¨­å®šç·¨é›†ï¼ˆãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ï¼‰
exchange-analytics alert-config edit

# è¨­å®šå†èª­ã¿è¾¼ã¿
exchange-analytics alert-config reload
```

#### 2. ã‚¢ãƒ©ãƒ¼ãƒˆç›£è¦–ãƒ»ç®¡ç†

```bash
# ã‚¢ãƒ©ãƒ¼ãƒˆä¸€è¦§è¡¨ç¤º
exchange-analytics monitor alerts

# ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã‚ªãƒ—ã‚·ãƒ§ãƒ³
exchange-analytics monitor alerts --limit 10
exchange-analytics monitor alerts --severity high
exchange-analytics monitor alerts --alert-type system_resource
exchange-analytics monitor alerts --active-only

# ã‚¢ãƒ©ãƒ¼ãƒˆç¢ºèª
exchange-analytics monitor alerts acknowledge <alert_id> --by <user>

# ã‚¢ãƒ©ãƒ¼ãƒˆè§£æ±º
exchange-analytics monitor alerts resolve <alert_id> --by <user>
```

### ğŸ“Š CLIå‡ºåŠ›ä¾‹

#### ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®šè¡¨ç¤º

```
ğŸš¨ ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®š
                ğŸ’° ãƒ¬ãƒ¼ãƒˆé–¾å€¤ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®š
â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”“
â”ƒ é€šè²¨ãƒšã‚¢ â”ƒ ä¸Šé™é–¾å€¤ â”ƒ ä¸‹é™é–¾å€¤ â”ƒ ãƒã‚§ãƒƒã‚¯é–“éš” â”ƒ é‡è¦åº¦ â”ƒ
â”¡â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”©
â”‚ USD/JPY  â”‚ 151.0    â”‚ 140.0    â”‚ 5åˆ†          â”‚ HIGH   â”‚
â”‚ EUR/USD  â”‚ 1.15     â”‚ 1.05     â”‚ 5åˆ†          â”‚ MEDIUM â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ã‚¢ãƒ©ãƒ¼ãƒˆä¸€è¦§è¡¨ç¤º

```
ğŸš¨ ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚¢ãƒ©ãƒ¼ãƒˆç¢ºèªä¸­...
                                                   ğŸš¨ Active Alerts
â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”“
â”ƒ ID â”ƒ Type              â”ƒ Severity â”ƒ Message                                          â”ƒ Created             â”ƒ Status â”ƒ
â”¡â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”©
â”‚ 6  â”‚ system_resource   â”‚ MEDIUM   â”‚ CPU usage exceeded warning threshold (75%)       â”‚ 2025-08-16 17:51:01 â”‚ ACTIVE â”‚
â”‚ 5  â”‚ data_fetch_error  â”‚ MEDIUM   â”‚ Failed to fetch 5-minute data from Yahoo Finance â”‚ 2025-08-16 17:00:24 â”‚ ACTIVE â”‚
â”‚ 4  â”‚ pattern_detection â”‚ HIGH     â”‚ Strong reversal pattern detected on USD/JPY      â”‚ 2025-08-16 17:00:24 â”‚ ACTIVE â”‚
â”‚ 1  â”‚ rate_threshold    â”‚ HIGH     â”‚ USD/JPY rate exceeded threshold (151.00)         â”‚ 2025-08-16 17:00:24 â”‚ ACTIVE â”‚
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â•­â”€ ğŸ“Š Alert Summary â”€â”€â•®
â”‚ ğŸš¨ Active Alerts: 4 â”‚
â”‚ âš ï¸ High Severity: 2  â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
```
---

## å®Ÿè£…è©³ç´°

### ğŸ“ ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ

```
src/
â”œâ”€â”€ infrastructure/
â”‚   â”œâ”€â”€ database/
â”‚   â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”‚   â”œâ”€â”€ alert_model.py          # ã‚¢ãƒ©ãƒ¼ãƒˆãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«
â”‚   â”‚   â”‚   â””â”€â”€ base.py                 # åŸºæœ¬ãƒ¢ãƒ‡ãƒ«ï¼ˆã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ç®¡ç†ï¼‰
â”‚   â”‚   â””â”€â”€ repositories/
â”‚   â”‚       â””â”€â”€ alert_repository_impl.py # ã‚¢ãƒ©ãƒ¼ãƒˆãƒªãƒã‚¸ãƒˆãƒªå®Ÿè£…
â”‚   â””â”€â”€ config/
â”‚       â””â”€â”€ alert_config_manager.py     # ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®šç®¡ç†
â”œâ”€â”€ presentation/
â”‚   â””â”€â”€ cli/
â”‚       â””â”€â”€ commands/
â”‚           â”œâ”€â”€ alert_config_commands.py # ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®šCLI
â”‚           â””â”€â”€ monitor_commands.py      # ç›£è¦–ãƒ»è¡¨ç¤ºCLI
â””â”€â”€ utils/
    â””â”€â”€ logging_config.py               # ãƒ­ã‚°è¨­å®š

config/
â””â”€â”€ alerts.yaml                         # ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«

.env                                    # ç’°å¢ƒå¤‰æ•°è¨­å®š
```

### ğŸ”§ ä¸»è¦ã‚¯ãƒ©ã‚¹ãƒ»ãƒ¡ã‚½ãƒƒãƒ‰

#### AlertModel

```python
class AlertModel(BaseModel):
    """ã‚¢ãƒ©ãƒ¼ãƒˆãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«"""

    __tablename__ = "alerts"

    # ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å®šç¾©
    uuid = Column(String(36), unique=True, nullable=False)
    alert_type = Column(String(50), nullable=False, index=True)
    severity = Column(String(20), nullable=False, index=True)
    status = Column(String(20), nullable=False, default="active")
    # ... ãã®ä»–ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰

    def __init__(self, **kwargs):
        """åˆæœŸåŒ–æ™‚ã«UUIDã‚’è‡ªå‹•ç”Ÿæˆ"""
        if "uuid" not in kwargs:
            kwargs["uuid"] = str(uuid.uuid4())
        super().__init__(**kwargs)

    def acknowledge(self, acknowledged_by: str) -> None:
        """ã‚¢ãƒ©ãƒ¼ãƒˆã‚’ç¢ºèªæ¸ˆã¿ã«ã™ã‚‹"""

    def resolve(self, resolved_by: str) -> None:
        """ã‚¢ãƒ©ãƒ¼ãƒˆã‚’è§£æ±ºæ¸ˆã¿ã«ã™ã‚‹"""

    def is_active(self) -> bool:
        """ã‚¢ãƒ©ãƒ¼ãƒˆãŒã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‹ã©ã†ã‹ã‚’åˆ¤å®š"""

    def is_high_severity(self) -> bool:
        """é«˜é‡è¦åº¦ã‹ã©ã†ã‹ã‚’åˆ¤å®š"""
```

#### AlertRepositoryImpl

```python
class AlertRepositoryImpl(BaseRepositoryImpl):
    """ã‚¢ãƒ©ãƒ¼ãƒˆãƒªãƒã‚¸ãƒˆãƒªå®Ÿè£…"""

    async def find_active_alerts(
        self,
        limit: Optional[int] = None,
        severity: Optional[str] = None,
        alert_type: Optional[str] = None,
    ) -> List[AlertModel]:
        """ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªã‚¢ãƒ©ãƒ¼ãƒˆã‚’å–å¾—"""

    async def find_by_severity(
        self, severity: str, limit: Optional[int] = None
    ) -> List[AlertModel]:
        """é‡è¦åº¦ã§ã‚¢ãƒ©ãƒ¼ãƒˆã‚’æ¤œç´¢"""

    async def find_by_type(
        self, alert_type: str, limit: Optional[int] = None
    ) -> List[AlertModel]:
        """ã‚¢ãƒ©ãƒ¼ãƒˆã‚¿ã‚¤ãƒ—ã§æ¤œç´¢"""

    async def find_recent_alerts(
        self, hours: int = 24, limit: Optional[int] = None
    ) -> List[AlertModel]:
        """æœ€è¿‘ã®ã‚¢ãƒ©ãƒ¼ãƒˆã‚’å–å¾—"""

    async def get_alert_statistics(self) -> Dict[str, Any]:
        """ã‚¢ãƒ©ãƒ¼ãƒˆçµ±è¨ˆæƒ…å ±ã‚’å–å¾—"""

    async def acknowledge_alert(self, alert_id: int, acknowledged_by: str) -> bool:
        """ã‚¢ãƒ©ãƒ¼ãƒˆã‚’ç¢ºèªæ¸ˆã¿ã«ã™ã‚‹"""

    async def resolve_alert(self, alert_id: int, resolved_by: str) -> bool:
        """ã‚¢ãƒ©ãƒ¼ãƒˆã‚’è§£æ±ºæ¸ˆã¿ã«ã™ã‚‹"""

    async def create_alert(
        self,
        alert_type: str,
        severity: str,
        message: str,
        currency_pair: Optional[str] = None,
        details: Optional[Dict] = None,
        related_data_id: Optional[int] = None,
        related_data_type: Optional[str] = None,
    ) -> Optional[AlertModel]:
        """æ–°ã—ã„ã‚¢ãƒ©ãƒ¼ãƒˆã‚’ä½œæˆ"""
```

### â° ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ç®¡ç†

#### æ—¥æœ¬æ™‚é–“è¨­å®š

```python
def get_jst_now() -> datetime:
    """æ—¥æœ¬æ™‚é–“ã®ç¾åœ¨æ™‚åˆ»ã‚’å–å¾—"""
    jst = pytz.timezone('Asia/Tokyo')
    return datetime.now(jst).replace(tzinfo=None)

class BaseModel(Base):
    """å…¨ãƒ¢ãƒ‡ãƒ«ã®åŸºåº•ã‚¯ãƒ©ã‚¹"""

    created_at = Column(
        DateTime(timezone=True),
        nullable=False,
        default=get_jst_now,
        comment="ä½œæˆæ—¥æ™‚"
    )
    updated_at = Column(
        DateTime(timezone=True),
        nullable=False,
        default=get_jst_now,
        onupdate=get_jst_now,
        comment="æ›´æ–°æ—¥æ™‚",
    )
```

#### CLIè¡¨ç¤ºã§ã®æ—¥æœ¬æ™‚é–“å¤‰æ›

```python
# ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ã‚’JSTã«å¤‰æ›
created_time = alert.created_at
if created_time:
    # ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³æƒ…å ±ãŒãªã„å ´åˆã¯JSTã¨ã—ã¦æ‰±ã†
    if created_time.tzinfo is None:
        jst = pytz.timezone('Asia/Tokyo')
        created_time = jst.localize(created_time)

    # JSTã«å¤‰æ›ã—ã¦è¡¨ç¤º
    jst = pytz.timezone('Asia/Tokyo')
    jst_time = created_time.astimezone(jst)
    created_str = jst_time.strftime("%Y-%m-%d %H:%M:%S")
else:
    created_str = "N/A"
```

---

## æ‹¡å¼µãƒ»ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º

### ğŸ”§ æ–°ã—ã„ã‚¢ãƒ©ãƒ¼ãƒˆã‚¿ã‚¤ãƒ—ã®è¿½åŠ 

#### 1. è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã«è¿½åŠ 

```yaml
# config/alerts.yaml
new_alert_type_alerts:
  enabled: true
  threshold: 100
  severity: "medium"
  check_interval_minutes: 10
```

#### 2. ç’°å¢ƒå¤‰æ•°ã«è¿½åŠ 

```bash
# .env
DISCORD_NEW_ALERT_WEBHOOK_URL=https://discord.com/api/webhooks/...
```

#### 3. è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã«Webhookè¨­å®šã‚’è¿½åŠ 

```yaml
notification_settings:
  discord:
    alert_type_webhooks:
      new_alert_type: "${DISCORD_NEW_ALERT_WEBHOOK_URL}"
```

#### 4. ã‚¢ãƒ©ãƒ¼ãƒˆä½œæˆã‚³ãƒ¼ãƒ‰

```python
# ã‚¢ãƒ©ãƒ¼ãƒˆä½œæˆä¾‹
alert = await alert_repo.create_alert(
    alert_type='new_alert_type',
    severity='medium',
    message='New alert triggered',
    details={'threshold': 100, 'current_value': 105}
)
```

### ğŸ¨ æ–°ã—ã„é€šçŸ¥ãƒãƒ£ãƒ³ãƒãƒ«ã®è¿½åŠ 

#### 1. è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã«è¿½åŠ 

```yaml
notification_settings:
  slack:
    enabled: true
    webhook_url: "${SLACK_WEBHOOK_URL}"
    alert_type_webhooks:
      system_resource: "${SLACK_MONITORING_WEBHOOK_URL}"
      rate_threshold: "${SLACK_TRADING_WEBHOOK_URL}"
```

#### 2. é€šçŸ¥ã‚¯ãƒ©ã‚¹ã®å®Ÿè£…

```python
class SlackNotifier:
    """Slacké€šçŸ¥ã‚¯ãƒ©ã‚¹"""

    def __init__(self, webhook_url: str):
        self.webhook_url = webhook_url

    async def send_alert(self, alert: AlertModel) -> bool:
        """ã‚¢ãƒ©ãƒ¼ãƒˆã‚’Slackã«é€ä¿¡"""
        # å®Ÿè£…
        pass
```

### ğŸ“Š æ–°ã—ã„çµ±è¨ˆæƒ…å ±ã®è¿½åŠ 

#### 1. AlertRepositoryImplã«ãƒ¡ã‚½ãƒƒãƒ‰è¿½åŠ 

```python
async def get_custom_statistics(self) -> Dict[str, Any]:
    """ã‚«ã‚¹ã‚¿ãƒ çµ±è¨ˆæƒ…å ±ã‚’å–å¾—"""
    try:
        # ã‚«ã‚¹ã‚¿ãƒ ã‚¯ã‚¨ãƒªã®å®Ÿè£…
        query = select(
            AlertModel.alert_type,
            func.count(AlertModel.id)
        ).group_by(AlertModel.alert_type)

        result = await self.session.execute(query)
        return {"custom_stats": dict(result)}

    except Exception as e:
        logger.error(f"Error getting custom statistics: {e}")
        return {}
```

#### 2. CLIã‚³ãƒãƒ³ãƒ‰ã«è¿½åŠ 

```python
@app.command()
def custom_stats():
    """ã‚«ã‚¹ã‚¿ãƒ çµ±è¨ˆæƒ…å ±ã‚’è¡¨ç¤º"""
    # å®Ÿè£…
    pass
```

---

## é‹ç”¨ãƒ»ç›£è¦–

### ğŸ” æ—¥å¸¸çš„ãªç›£è¦–é …ç›®

#### 1. ã‚¢ãƒ©ãƒ¼ãƒˆçŠ¶æ³ç¢ºèª

```bash
# ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚¢ãƒ©ãƒ¼ãƒˆç¢ºèª
exchange-analytics monitor alerts --active-only

# é«˜é‡è¦åº¦ã‚¢ãƒ©ãƒ¼ãƒˆç¢ºèª
exchange-analytics monitor alerts --severity high

# çµ±è¨ˆæƒ…å ±ç¢ºèª
exchange-analytics monitor alerts --stats
```

#### 2. è¨­å®šç¢ºèª

```bash
# è¨­å®šæ¤œè¨¼
exchange-analytics alert-config validate

# è¨­å®šè¡¨ç¤º
exchange-analytics alert-config show
```

#### 3. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ç›£è¦–

```sql
-- ã‚¢ãƒ©ãƒ¼ãƒˆçµ±è¨ˆ
SELECT
    alert_type,
    severity,
    status,
    COUNT(*) as count
FROM alerts
GROUP BY alert_type, severity, status
ORDER BY alert_type, severity;

-- æœ€è¿‘ã®ã‚¢ãƒ©ãƒ¼ãƒˆ
SELECT
    id,
    alert_type,
    severity,
    message,
    created_at
FROM alerts
WHERE created_at >= NOW() - INTERVAL '24 hours'
ORDER BY created_at DESC;
```

### ğŸ“ˆ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–

#### 1. ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ä½¿ç”¨çŠ¶æ³

```sql
-- ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ä½¿ç”¨çŠ¶æ³ç¢ºèª
SELECT
    schemaname,
    tablename,
    indexname,
    idx_scan,
    idx_tup_read,
    idx_tup_fetch
FROM pg_stat_user_indexes
WHERE tablename = 'alerts';
```

#### 2. ãƒ†ãƒ¼ãƒ–ãƒ«ã‚µã‚¤ã‚ºç›£è¦–

```sql
-- ãƒ†ãƒ¼ãƒ–ãƒ«ã‚µã‚¤ã‚ºç¢ºèª
SELECT
    schemaname,
    tablename,
    pg_size_pretty(pg_total_relation_size(schemaname||'.'||tablename)) as size
FROM pg_tables
WHERE tablename = 'alerts';
```

### ğŸ”„ å®šæœŸãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹

#### 1. å¤ã„ã‚¢ãƒ©ãƒ¼ãƒˆã®å‰Šé™¤

```sql
-- è§£æ±ºæ¸ˆã¿ã‚¢ãƒ©ãƒ¼ãƒˆã®å‰Šé™¤ï¼ˆ30æ—¥ä»¥ä¸Šå‰ï¼‰
DELETE FROM alerts
WHERE status = 'resolved'
AND resolved_at < NOW() - INTERVAL '30 days';
```

#### 2. çµ±è¨ˆæƒ…å ±ã®æ›´æ–°

```sql
-- çµ±è¨ˆæƒ…å ±ã®æ›´æ–°
ANALYZE alerts;
```

---

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ğŸš¨ ã‚ˆãã‚ã‚‹å•é¡Œã¨è§£æ±ºæ–¹æ³•

#### 1. ç’°å¢ƒå¤‰æ•°ãŒèª­ã¿è¾¼ã¾ã‚Œãªã„

**ç—‡çŠ¶**: `ç’°å¢ƒå¤‰æ•° XXX ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“` ã‚¨ãƒ©ãƒ¼

**åŸå› **: `.env`ãƒ•ã‚¡ã‚¤ãƒ«ãŒèª­ã¿è¾¼ã¾ã‚Œã¦ã„ãªã„

**è§£æ±ºæ–¹æ³•**:
```bash
# .envãƒ•ã‚¡ã‚¤ãƒ«ã®å­˜åœ¨ç¢ºèª
ls -la .env

# ç’°å¢ƒå¤‰æ•°ã®ç¢ºèª
echo $DISCORD_WEBHOOK_URL

# python-dotenvã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ç¢ºèª
pip list | grep dotenv
```

#### 2. ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ãŒUTCã§è¡¨ç¤ºã•ã‚Œã‚‹

**ç—‡çŠ¶**: CLIã§ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ãŒUTCæ™‚é–“ã§è¡¨ç¤ºã•ã‚Œã‚‹

**åŸå› **: ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³å¤‰æ›ãŒæ­£ã—ãè¡Œã‚ã‚Œã¦ã„ãªã„

**è§£æ±ºæ–¹æ³•**:
```python
# ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³æƒ…å ±ã®ç¢ºèª
print(f"Timezone info: {datetime_obj.tzinfo}")

# æ‰‹å‹•ã§JSTã«å¤‰æ›
import pytz
jst = pytz.timezone('Asia/Tokyo')
jst_time = datetime_obj.astimezone(jst)
```

#### 3. Discordé€šçŸ¥ãŒé€ä¿¡ã•ã‚Œãªã„

**ç—‡çŠ¶**: ã‚¢ãƒ©ãƒ¼ãƒˆã¯ä½œæˆã•ã‚Œã‚‹ãŒDiscordã«é€šçŸ¥ãŒå±Šã‹ãªã„

**åŸå› **: Webhook URLãŒç„¡åŠ¹ã¾ãŸã¯æ¨©é™ä¸è¶³

**è§£æ±ºæ–¹æ³•**:
```bash
# Webhook URLã®ç¢ºèª
echo $DISCORD_WEBHOOK_URL

# æ‰‹å‹•ã§Webhookãƒ†ã‚¹ãƒˆ
curl -X POST -H "Content-Type: application/json" \
  -d '{"content":"Test message"}' \
  $DISCORD_WEBHOOK_URL
```

#### 4. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šã‚¨ãƒ©ãƒ¼

**ç—‡çŠ¶**: `connection failed` ã‚¨ãƒ©ãƒ¼

**åŸå› **: PostgreSQLæ¥ç¶šè¨­å®šã®å•é¡Œ

**è§£æ±ºæ–¹æ³•**:
```bash
# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šç¢ºèª
PGPASSWORD=exchange_password psql -h localhost -U exchange_analytics_user -d exchange_analytics_production_db

# ãƒ†ãƒ¼ãƒ–ãƒ«å­˜åœ¨ç¢ºèª
\dt alerts
```

### ğŸ”§ ãƒ‡ãƒãƒƒã‚°æ–¹æ³•

#### 1. ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«ã®å¤‰æ›´

```python
# ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«ã‚’DEBUGã«å¤‰æ›´
import logging
logging.getLogger().setLevel(logging.DEBUG)
```

#### 2. è¨­å®šå€¤ã®ç¢ºèª

```python
# è¨­å®šå€¤ã®ç¢ºèª
from src.infrastructure.config.alert_config_manager import AlertConfigManager

config_manager = AlertConfigManager()
print(config_manager.get_discord_webhook_url('system_resource'))
```

#### 3. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ç›´æ¥ç¢ºèª

```sql
-- æœ€æ–°ã®ã‚¢ãƒ©ãƒ¼ãƒˆç¢ºèª
SELECT * FROM alerts ORDER BY created_at DESC LIMIT 5;

-- ã‚¢ãƒ©ãƒ¼ãƒˆã‚¿ã‚¤ãƒ—åˆ¥çµ±è¨ˆ
SELECT alert_type, COUNT(*) FROM alerts GROUP BY alert_type;
```

---

## ä»Šå¾Œã®æ‹¡å¼µè¨ˆç”»

### ğŸš€ çŸ­æœŸè¨ˆç”»ï¼ˆ1-2ãƒ¶æœˆï¼‰

#### 1. ã‚¢ãƒ©ãƒ¼ãƒˆã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ©Ÿèƒ½
- ä¸€å®šæ™‚é–“çµŒéå¾Œã®è‡ªå‹•ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
- é‡è¦åº¦ã«å¿œã˜ãŸé€šçŸ¥é »åº¦ã®èª¿æ•´
- ç®¡ç†è€…ã¸ã®è‡ªå‹•é€šçŸ¥

#### 2. ã‚¢ãƒ©ãƒ¼ãƒˆå±¥æ­´ãƒ»åˆ†ææ©Ÿèƒ½
- ã‚¢ãƒ©ãƒ¼ãƒˆç™ºç”Ÿãƒ‘ã‚¿ãƒ¼ãƒ³ã®åˆ†æ
- çµ±è¨ˆãƒ¬ãƒãƒ¼ãƒˆã®è‡ªå‹•ç”Ÿæˆ
- ã‚¢ãƒ©ãƒ¼ãƒˆåŠ¹ç‡æ€§ã®æ¸¬å®š

#### 3. Web UI ã®è¿½åŠ 
- ã‚¢ãƒ©ãƒ¼ãƒˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ç›£è¦–ç”»é¢
- è¨­å®šç®¡ç†ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹

### ğŸŒŸ ä¸­æœŸè¨ˆç”»ï¼ˆ3-6ãƒ¶æœˆï¼‰

#### 1. æ©Ÿæ¢°å­¦ç¿’ã«ã‚ˆã‚‹ç•°å¸¸æ¤œå‡º
- ç•°å¸¸ãƒ‘ã‚¿ãƒ¼ãƒ³ã®è‡ªå‹•å­¦ç¿’
- äºˆæ¸¬çš„ã‚¢ãƒ©ãƒ¼ãƒˆæ©Ÿèƒ½
- èª¤å ±ã®è‡ªå‹•ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°

#### 2. ãƒãƒ«ãƒãƒãƒ£ãƒ³ãƒãƒ«é€šçŸ¥
- Slackçµ±åˆ
- ãƒ¡ãƒ¼ãƒ«é€šçŸ¥
- SMSé€šçŸ¥
- ãƒ—ãƒƒã‚·ãƒ¥é€šçŸ¥

#### 3. ã‚¢ãƒ©ãƒ¼ãƒˆãƒ«ãƒ¼ãƒ«ã‚¨ãƒ³ã‚¸ãƒ³
- è¤‡é›‘ãªæ¡ä»¶è¨­å®š
- å‹•çš„ãƒ«ãƒ¼ãƒ«ç”Ÿæˆ
- ãƒ«ãƒ¼ãƒ«ã®è‡ªå‹•æœ€é©åŒ–

### ğŸ¯ é•·æœŸè¨ˆç”»ï¼ˆ6ãƒ¶æœˆä»¥ä¸Šï¼‰

#### 1. AI ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆæ©Ÿèƒ½
- è‡ªç„¶è¨€èªã§ã®ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®š
- è‡ªå‹•ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°
- ã‚¤ãƒ³ãƒ†ãƒªã‚¸ã‚§ãƒ³ãƒˆãªæ¨å¥¨äº‹é …

#### 2. ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºæ©Ÿèƒ½
- ãƒãƒ«ãƒãƒ†ãƒŠãƒ³ãƒˆå¯¾å¿œ
- SSOçµ±åˆ
- ç›£æŸ»ãƒ­ã‚°æ©Ÿèƒ½

#### 3. å¤–éƒ¨ã‚·ã‚¹ãƒ†ãƒ çµ±åˆ
- Prometheusçµ±åˆ
- Grafanaçµ±åˆ
- PagerDutyçµ±åˆ

---

## ğŸ“š å‚è€ƒè³‡æ–™

### ğŸ”— é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- [CLIæ©Ÿèƒ½èª¬æ˜æ›¸](./2025-08-15_CLIæ©Ÿèƒ½_ExchangeAnalyticsSystem_CLIæ©Ÿèƒ½èª¬æ˜æ›¸.md)
- [ãƒ†ã‚¯ãƒ‹ã‚«ãƒ«æŒ‡æ¨™çµ±åˆè¨­è¨ˆæ›¸](./2025-08-13_ãƒ†ã‚¯ãƒ‹ã‚«ãƒ«æŒ‡æ¨™çµ±åˆ_TA-Libãƒ†ã‚¯ãƒ‹ã‚«ãƒ«æŒ‡æ¨™çµ±åˆè¨­è¨ˆæ›¸.md)
- [é«˜åº¦åˆ†æã‚·ã‚¹ãƒ†ãƒ ](./2025-08-15_åˆ†æã‚·ã‚¹ãƒ†ãƒ _é«˜åº¦åˆ†æã‚·ã‚¹ãƒ†ãƒ .md)

### ğŸ“– æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯
- **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹**: PostgreSQL 15+
- **ORM**: SQLAlchemy 2.0
- **CLI**: Typer
- **è¨­å®šç®¡ç†**: Pydantic + YAML
- **é€šçŸ¥**: Discord Webhook
- **ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³**: pytz

### ğŸ› ï¸ é–‹ç™ºç’°å¢ƒ
- **Python**: 3.11+
- **ä¾å­˜é–¢ä¿‚ç®¡ç†**: pip
- **ç’°å¢ƒå¤‰æ•°**: python-dotenv
- **ãƒ­ã‚°**: logging

---

## ğŸ“ æ›´æ–°å±¥æ­´

| æ—¥ä»˜ | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | å¤‰æ›´å†…å®¹ | æ‹…å½“è€… |
|------|-----------|----------|--------|
| 2025-08-16 | 1.0.0 | åˆç‰ˆä½œæˆ | System |
| 2025-08-16 | 1.1.0 | ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ä¿®æ­£ | System |
| 2025-08-16 | 1.2.0 | Discordãƒãƒ£ãƒ³ãƒãƒ«åˆ†é›¢æ©Ÿèƒ½è¿½åŠ  | System |

---

**ğŸ“§ ãŠå•ã„åˆã‚ã›**: ã‚·ã‚¹ãƒ†ãƒ ç®¡ç†è€…
**ğŸ“… æœ€çµ‚æ›´æ–°**: 2025-08-16
**ğŸ”„ ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 1.2.0
