**æ—§ãƒ•ã‚¡ã‚¤ãƒ«å**: `DEVELOPMENT_SETUP.md`  

# é–‹ç™ºç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰

**ä½œæˆæ—¥**: 2025 å¹´ 8 æœˆ 9 æ—¥
**ç›®çš„**: Exchange Analytics é–‹ç™ºå‰ã®å¿…é ˆæº–å‚™ä½œæ¥­

## ğŸ” ç¾åœ¨ã®çŠ¶æ³åˆ†æ

### âœ… æ—¢ã«æº–å‚™æ¸ˆã¿

- Python 3.11.13 ç’°å¢ƒ
- åŸºæœ¬çš„ãª requirements.txt
- Dockerãƒ»docker-compose è¨­å®š
- åŸºæœ¬çš„ãª .env ãƒ•ã‚¡ã‚¤ãƒ«
- Git ãƒªãƒã‚¸ãƒˆãƒªåˆæœŸåŒ–
- è©³ç´°è¨­è¨ˆæ›¸ (9 ãƒ•ã‚¡ã‚¤ãƒ«)
- TODO.yaml (å®Ÿè£…è¨ˆç”»)

### âŒ ä¸è¶³ã—ã¦ã„ã‚‹æº–å‚™ä½œæ¥­

## 1. ğŸ—ï¸ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ ã®æº–å‚™

### 1.1 ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ä½œæˆ

```bash
mkdir -p src/{domain,application,infrastructure,presentation}
mkdir -p src/domain/{entities,value_objects,repositories,services}
mkdir -p src/application/{commands,queries,handlers,interfaces,dto,exceptions}
mkdir -p src/infrastructure/{database,external_apis,messaging,cache,monitoring}
mkdir -p src/presentation/{api,web,cli}
mkdir -p tests/{unit,integration,e2e}
mkdir -p config/{environments,plugins}
mkdir -p plugins/{interfaces,technical_indicators,analysis,reports}
mkdir -p docs/{api,architecture,deployment}
mkdir -p scripts/{setup,migration,deployment}
```

### 1.2 Python ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸åˆæœŸåŒ–

```bash
find src tests plugins -type d -exec touch {}/__init__.py \;
```

## 2. ğŸ“¦ ä¾å­˜é–¢ä¿‚ã®å®Œå…¨åŒ–

### 2.1 requirements ã®åˆ†å‰²ãƒ»æ›´æ–°

ç¾åœ¨ã® `requirements.txt` ã‚’åˆ†å‰²ã—ã¦ç®¡ç†ã—ã‚„ã™ãã™ã‚‹ï¼š

**requirements/base.txt** (æœ¬ç•ªç”¨åŸºæœ¬ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸)

```
# Web Framework
Flask==3.0.0
Flask-CORS==4.0.0

# Database
SQLAlchemy==2.0.23
alembic==1.12.1
asyncpg==0.29.0

# Dependencies Injection
dependency-injector==4.41.0

# Data & Analysis
pandas==2.1.4
numpy==1.25.2
ta==0.10.2

# External APIs
aiohttp==3.9.1
requests==2.31.0
PyGithub==1.59.1
openai==1.3.8
alpha-vantage==2.3.1

# Async Support
asyncio-mqtt==0.16.1

# Caching
redis==5.0.1

# Monitoring
psutil==5.9.6
prometheus-client==0.19.0

# Validation
marshmallow==3.20.1
pydantic==2.5.0

# Environment
python-dotenv==1.0.0

# Discord Integration
discord-webhook==1.3.0

# Job Scheduling
APScheduler==3.10.4

# Cryptography
cryptography==41.0.8
```

**requirements/development.txt**

```
-r base.txt

# Testing
pytest==7.4.3
pytest-cov==4.1.0
pytest-asyncio==0.21.1
pytest-mock==3.12.0
factory-boy==3.3.0

# Code Quality
black==23.11.0
flake8==6.1.0
isort==5.12.0
mypy==1.7.1
bandit==1.7.5

# Documentation
sphinx==7.2.6
sphinx-rtd-theme==1.3.0

# Development Tools
pre-commit==3.5.0
ipython==8.17.2
jupyter==1.0.0

# Database Tools
psycopg2-binary==2.9.9
```

**requirements/production.txt**

```
-r base.txt

# Production WSGI Server
gunicorn==21.2.0

# Production Database
psycopg2==2.9.9

# Monitoring
sentry-sdk==1.38.0
```

### 2.2 ä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
pip install -r requirements/development.txt
```

## 3. âš™ï¸ è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®æ•´å‚™

### 3.1 ç’°å¢ƒè¨­å®šã®åˆ†å‰²

**config/base.py**

```python
"""åŸºæœ¬è¨­å®šã‚¯ãƒ©ã‚¹"""
import os
from typing import Optional

class BaseConfig:
    """åŸºæœ¬è¨­å®š"""
    # Flask
    SECRET_KEY: str = os.getenv('SECRET_KEY', 'dev-secret-key-change-in-production')
    DEBUG: bool = False
    TESTING: bool = False

    # Database
    DATABASE_URL: str = os.getenv('DATABASE_URL', 'sqlite:///exchange_app.db')
    DATABASE_ECHO: bool = os.getenv('DATABASE_ECHO', 'False').lower() == 'true'

    # Redis
    REDIS_URL: str = os.getenv('REDIS_URL', 'redis://localhost:6379/0')

    # External APIs
    ALPHA_VANTAGE_API_KEY: Optional[str] = os.getenv('ALPHA_VANTAGE_API_KEY')
    OPENAI_API_KEY: Optional[str] = os.getenv('OPENAI_API_KEY')

    # GitHub
    GITHUB_TOKEN: Optional[str] = os.getenv('GITHUB_TOKEN')
    GITHUB_WEBHOOK_SECRET: Optional[str] = os.getenv('GITHUB_WEBHOOK_SECRET')

    # Discord
    DISCORD_WEBHOOK_URL: Optional[str] = os.getenv('DISCORD_WEBHOOK_URL')

    # Logging
    LOG_LEVEL: str = os.getenv('LOG_LEVEL', 'INFO')
    LOG_FORMAT: str = '%(asctime)s - %(name)s - %(levelname)s - %(message)s'
```

**config/development.py**

```python
from .base import BaseConfig

class DevelopmentConfig(BaseConfig):
    DEBUG = True
    DATABASE_ECHO = True
    LOG_LEVEL = 'DEBUG'
```

**config/production.py**

```python
from .base import BaseConfig

class ProductionConfig(BaseConfig):
    DEBUG = False
    TESTING = False
    DATABASE_ECHO = False
```

**config/testing.py**

```python
from .base import BaseConfig

class TestingConfig(BaseConfig):
    TESTING = True
    DATABASE_URL = 'sqlite:///:memory:'
    REDIS_URL = 'redis://localhost:6379/1'
```

### 3.2 .env.example ã®æ›´æ–°

```bash
# Flask Configuration
SECRET_KEY=your-secret-key-here
FLASK_ENV=development
DEBUG=True

# Database
DATABASE_URL=postgresql://user:password@localhost:5432/exchange_analytics
DATABASE_ECHO=False

# Redis
REDIS_URL=redis://localhost:6379/0

# External API Keys
ALPHA_VANTAGE_API_KEY=your-alpha-vantage-key
OPENAI_API_KEY=your-openai-key

# GitHub Integration
GITHUB_TOKEN=your-github-token
GITHUB_WEBHOOK_SECRET=your-webhook-secret
GITHUB_REPO_OWNER=your-username
GITHUB_REPO_NAME=exchange-analytics

# Discord Integration
DISCORD_WEBHOOK_URL=your-discord-webhook-url
DISCORD_CHANNEL_ID=your-channel-id

# Email Configuration (Optional)
SMTP_SERVER=smtp.gmail.com
SMTP_PORT=587
EMAIL_USERNAME=your-email@gmail.com
EMAIL_PASSWORD=your-app-password

# Monitoring
LOG_LEVEL=INFO
SENTRY_DSN=your-sentry-dsn

# AI Analysis
AI_REPORT_SCHEDULE=0 9 * * *  # Daily at 9 AM
OPENAI_MODEL=gpt-4
```

## 4. ğŸ”§ é–‹ç™ºãƒ„ãƒ¼ãƒ«ã®è¨­å®š

### 4.1 pre-commit è¨­å®š

**.pre-commit-config.yaml**

```yaml
repos:
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.5.0
    hooks:
      - id: trailing-whitespace
      - id: end-of-file-fixer
      - id: check-yaml
      - id: check-added-large-files
      - id: check-merge-conflict

  - repo: https://github.com/psf/black
    rev: 23.11.0
    hooks:
      - id: black

  - repo: https://github.com/pycqa/isort
    rev: 5.12.0
    hooks:
      - id: isort

  - repo: https://github.com/pycqa/flake8
    rev: 6.1.0
    hooks:
      - id: flake8

  - repo: https://github.com/pre-commit/mirrors-mypy
    rev: v1.7.1
    hooks:
      - id: mypy
        additional_dependencies: [types-requests, types-PyYAML]
```

### 4.2 pytest è¨­å®š

**pytest.ini**

```ini
[tool:pytest]
testpaths = tests
python_files = test_*.py
python_classes = Test*
python_functions = test_*
addopts =
    --verbose
    --tb=short
    --cov=src
    --cov-report=html
    --cov-report=term-missing
    --cov-fail-under=85
asyncio_mode = auto
```

### 4.3 mypy è¨­å®š

**mypy.ini**

```ini
[mypy]
python_version = 3.11
warn_return_any = True
warn_unused_configs = True
disallow_untyped_defs = True
disallow_incomplete_defs = True
check_untyped_defs = True
disallow_untyped_decorators = True
no_implicit_optional = True
warn_redundant_casts = True
warn_unused_ignores = True
warn_no_return = True
warn_unreachable = True
strict_equality = True

[mypy-tests.*]
disallow_untyped_defs = False
```

### 4.4 flake8 è¨­å®š

**.flake8**

```ini
[flake8]
max-line-length = 88
extend-ignore = E203, W503
exclude =
    .git,
    __pycache__,
    .pytest_cache,
    .mypy_cache,
    .venv,
    venv,
    migrations
```

### 4.5 black & isort è¨­å®š

**pyproject.toml**

```toml
[tool.black]
line-length = 88
target-version = ['py311']
include = '\.pyi?$'
extend-exclude = '''
/(
  migrations
)/
'''

[tool.isort]
profile = "black"
multi_line_output = 3
include_trailing_comma = true
force_grid_wrap = 0
use_parentheses = true
ensure_newline_before_comments = true
line_length = 88
skip = ["migrations"]
```

## 5. ğŸ—„ï¸ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æº–å‚™

### 5.1 Alembic åˆæœŸåŒ–

```bash
pip install alembic
alembic init migrations
```

### 5.2 SQLAlchemy è¨­å®š

**src/infrastructure/database/**init**.py**

```python
from sqlalchemy.ext.asyncio import AsyncSession, create_async_engine
from sqlalchemy.orm import sessionmaker

engine = None
async_session = None

def init_db(database_url: str):
    global engine, async_session
    engine = create_async_engine(database_url, echo=True)
    async_session = sessionmaker(engine, class_=AsyncSession, expire_on_commit=False)
```

## 6. ğŸ³ Docker ç’°å¢ƒæ•´å‚™

### 6.1 Dockerfile ã®æœ€é©åŒ–

**Dockerfile**

```dockerfile
FROM python:3.11-slim

WORKDIR /app

# ã‚·ã‚¹ãƒ†ãƒ ä¾å­˜é–¢ä¿‚
RUN apt-get update && apt-get install -y \
    gcc \
    g++ \
    && rm -rf /var/lib/apt/lists/*

# Python ä¾å­˜é–¢ä¿‚
COPY requirements/production.txt .
RUN pip install --no-cache-dir -r production.txt

# ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚³ãƒ¼ãƒ‰
COPY . .

# érootãƒ¦ãƒ¼ã‚¶ãƒ¼ã§å®Ÿè¡Œ
RUN useradd -m appuser && chown -R appuser:appuser /app
USER appuser

EXPOSE 8000

CMD ["gunicorn", "--bind", "0.0.0.0:8000", "--workers", "4", "src.presentation.api.app:create_app()"]
```

### 6.2 docker-compose ã®æ‹¡å¼µ

**docker-compose.yml**

```yaml
version: "3.8"

services:
  app:
    build: .
    ports:
      - "8000:8000"
    environment:
      - DATABASE_URL=postgresql://postgres:password@db:5432/exchange_analytics
      - REDIS_URL=redis://redis:6379/0
    depends_on:
      - db
      - redis
    volumes:
      - .:/app

  db:
    image: postgres:15
    environment:
      POSTGRES_DB: exchange_analytics
      POSTGRES_USER: postgres
      POSTGRES_PASSWORD: password
    volumes:
      - postgres_data:/var/lib/postgresql/data
    ports:
      - "5432:5432"

  redis:
    image: redis:7-alpine
    ports:
      - "6379:6379"
    volumes:
      - redis_data:/data

  nginx:
    image: nginx:alpine
    ports:
      - "80:80"
    volumes:
      - ./nginx.conf:/etc/nginx/nginx.conf
    depends_on:
      - app

volumes:
  postgres_data:
  redis_data:
```

## 7. ğŸ“ ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæº–å‚™

### 7.1 README.md ã®æ›´æ–°

### 7.2 API ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæº–å‚™

### 7.3 é–‹ç™ºè€…ã‚¬ã‚¤ãƒ‰ä½œæˆ

## 8. ğŸ”’ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­å®š

### 8.1 secrets ç®¡ç†

### 8.2 .gitignore ã®å®Œå…¨åŒ–

## âœ… ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ç¢ºèªãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

- [ ] ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ä½œæˆ
- [ ] requirements åˆ†å‰²ãƒ»ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
- [ ] è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ
- [ ] é–‹ç™ºãƒ„ãƒ¼ãƒ«è¨­å®š (pre-commit, pytest, mypy ç­‰)
- [ ] ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹åˆæœŸåŒ–
- [ ] Docker ç’°å¢ƒãƒ†ã‚¹ãƒˆ
- [ ] Git hooks è¨­å®š
- [ ] ç’°å¢ƒå¤‰æ•°è¨­å®š
- [ ] ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ›´æ–°
- [ ] ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­å®š

ã“ã®æº–å‚™ãŒå®Œäº†å¾Œã€TODO.yaml ã® Phase 1 ã‹ã‚‰å®Ÿè£…é–‹å§‹ã§ãã¾ã™ã€‚
