**æ—§ãƒ•ã‚¡ã‚¤ãƒ«å**: `ENVIRONMENT_SECRETS_SETUP.md`  

# ğŸ” Environment Secrets è¨­å®šã‚¬ã‚¤ãƒ‰

## ğŸ“‹ æ¦‚è¦

GitHub Environment Secrets ã‚’è¨­å®šã™ã‚‹ã“ã¨ã§ã€æœ¬ç•ªç’°å¢ƒã§ã® 24 æ™‚é–“ç¨¼åƒã‚·ã‚¹ãƒ†ãƒ ã‚’ã‚ˆã‚Šå®‰å…¨ã«é‹ç”¨ã§ãã¾ã™ã€‚Repository Secrets ã‚ˆã‚Šã‚‚é«˜åº¦ãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã¨åˆ¶å¾¡ãŒå¯èƒ½ã§ã™ã€‚

## ğŸ¯ Environment Secrets ã®åˆ©ç‚¹

### ğŸ”’ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å‘ä¸Š

- **ç’°å¢ƒåˆ¥ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡**: æœ¬ç•ªç’°å¢ƒã¸ã®é™å®šçš„ãªã‚¢ã‚¯ã‚»ã‚¹
- **ä¿è­·ãƒ«ãƒ¼ãƒ«**: main ãƒ–ãƒ©ãƒ³ãƒã®ã¿å®Ÿè¡Œå¯èƒ½
- **æ‰¿èªãƒ•ãƒ­ãƒ¼**: é‡è¦ãªå¤‰æ›´æ™‚ã®æ‰¿èªãƒ—ãƒ­ã‚»ã‚¹
- **ãƒ­ã‚°è¿½è·¡**: ç’°å¢ƒåˆ¥ã®å®Ÿè¡Œå±¥æ­´ç®¡ç†

### ğŸ”§ é‹ç”¨ç®¡ç†

- **ç’°å¢ƒåˆ†é›¢**: production/staging/development
- **API Key ç®¡ç†**: ç’°å¢ƒã”ã¨ã®ç•°ãªã‚‹ã‚­ãƒ¼
- **ãƒ‡ãƒ—ãƒ­ã‚¤åˆ¶å¾¡**: æ®µéšçš„ãƒªãƒªãƒ¼ã‚¹
- **ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°**: ç’°å¢ƒåˆ¥ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–

### ğŸ“Š ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç‰¹æœ‰ã®åˆ©ç‚¹

- **æœ¬ç•ª Discord vs ãƒ†ã‚¹ãƒˆ Discord**: ãƒãƒ£ãƒ³ãƒãƒ«åˆ†é›¢
- **æœ¬ç•ª OpenAI vs é–‹ç™º OpenAI**: API ä½¿ç”¨é‡åˆ†é›¢
- **24 æ™‚é–“ç¨¼åƒã®å®‰å…¨æ€§**: èª¤å‹•ä½œé˜²æ­¢

## âš™ï¸ Environment è¨­å®šæ‰‹é †

### 1ï¸âƒ£ Production Environment ä½œæˆ

1. **GitHub ãƒªãƒã‚¸ãƒˆãƒªã«ã‚¢ã‚¯ã‚»ã‚¹**

   ```
   https://github.com/m37335/exchangeApp
   ```

2. **Settings â†’ Environments ã‚’ã‚¯ãƒªãƒƒã‚¯**

   - ã€ŒNew environmentã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯

3. **Environment åã‚’å…¥åŠ›**

   ```
   Environment name: production
   ```

4. **ã€ŒConfigure environmentã€ã‚’ã‚¯ãƒªãƒƒã‚¯**

### 2ï¸âƒ£ Environment ä¿è­·ãƒ«ãƒ¼ãƒ«è¨­å®š

**Protected branches (æ¨å¥¨)**:

```
â˜‘ï¸ Required reviewers: 0 (å€‹äººãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®å ´åˆ)
â˜‘ï¸ Restrict pushes to protected branches only
    Selected branches: main
```

**Deployment branches**:

```
â˜‘ï¸ Selected branches
    Branch name pattern: main
```

### 3ï¸âƒ£ Environment Secrets è¨­å®š

**Environment secrets ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã€ŒAdd secretã€**:

#### ğŸ¤– OPENAI_API_KEY

```
Name: OPENAI_API_KEY
Value: sk-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
```

#### ğŸ“¢ DISCORD_WEBHOOK_URL

```
Name: DISCORD_WEBHOOK_URL
Value: https://discord.com/api/webhooks/xxxxxxxxx/xxxxxxxxx
```

#### ğŸ“Š YAHOO_FINANCE_API_KEY (ã‚ªãƒ—ã‚·ãƒ§ãƒ³)

```
Name: YAHOO_FINANCE_API_KEY
Value: your_yahoo_finance_api_key
```

### 4ï¸âƒ£ è¨­å®šç¢ºèª

**Environment secrets ãŒè¡¨ç¤ºã•ã‚Œã‚‹**:

```
âœ… OPENAI_API_KEY (Last updated: just now)
âœ… DISCORD_WEBHOOK_URL (Last updated: just now)
âœ… YAHOO_FINANCE_API_KEY (Last updated: just now)
```

## ğŸ” Repository Secrets vs Environment Secrets

### Repository Secrets (åŸºæœ¬è¨­å®š)

**ç”¨é€”**: é–‹ç™ºãƒ»ãƒ†ã‚¹ãƒˆãƒ»æ‰‹å‹•å®Ÿè¡Œ
**è¨­å®šå ´æ‰€**: Settings â†’ Secrets and variables â†’ Actions
**ã‚¢ã‚¯ã‚»ã‚¹**: ãƒªãƒã‚¸ãƒˆãƒªå…¨ä½“ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‹ã‚‰åˆ©ç”¨å¯èƒ½

**è¨­å®šæ¨å¥¨é …ç›®**:

```
OPENAI_API_KEY_DEV (é–‹ç™ºç”¨)
DISCORD_WEBHOOK_URL_TEST (ãƒ†ã‚¹ãƒˆç”¨)
```

### Environment Secrets (æœ¬ç•ªè¨­å®š)

**ç”¨é€”**: æœ¬ç•ª 24 æ™‚é–“è‡ªå‹•ç¨¼åƒ
**è¨­å®šå ´æ‰€**: Settings â†’ Environments â†’ production
**ã‚¢ã‚¯ã‚»ã‚¹**: production ç’°å¢ƒæŒ‡å®šã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã®ã¿

**è¨­å®šæ¨å¥¨é …ç›®**:

```
OPENAI_API_KEY (æœ¬ç•ªç”¨)
DISCORD_WEBHOOK_URL (æœ¬ç•ªDiscord)
YAHOO_FINANCE_API_KEY (æœ¬ç•ªAPI)
```

## ğŸš€ ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼æ›´æ–°

### Environment æŒ‡å®š

**GitHub Actions ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼**ã«ä»¥ä¸‹ã‚’è¿½åŠ æ¸ˆã¿:

```yaml
jobs:
  integrated-analysis:
    name: ğŸ¯ çµ±åˆAIç›¸é–¢åˆ†æ
    runs-on: ubuntu-latest
    environment: production # â† EnvironmentæŒ‡å®š
    # ...

  technical-analysis:
    name: ğŸ“ˆ å€‹åˆ¥ãƒ†ã‚¯ãƒ‹ã‚«ãƒ«åˆ†æ
    runs-on: ubuntu-latest
    environment: production # â† EnvironmentæŒ‡å®š
    # ...
```

### Environment å¤‰æ•°ã‚¢ã‚¯ã‚»ã‚¹

**Secrets ã‚¢ã‚¯ã‚»ã‚¹æ–¹æ³•**ï¼ˆå¤‰æ›´ãªã—ï¼‰:

```yaml
- name: ğŸ”‘ Setup Environment Variables
  run: |
    echo "OPENAI_API_KEY=${{ secrets.OPENAI_API_KEY }}" >> $GITHUB_ENV
    echo "DISCORD_WEBHOOK_URL=${{ secrets.DISCORD_WEBHOOK_URL }}" >> $GITHUB_ENV
    echo "YAHOO_FINANCE_API_KEY=${{ secrets.YAHOO_FINANCE_API_KEY }}" >> $GITHUB_ENV
```

**GitHub Actions ãŒè‡ªå‹•ã§ production environment ã® secrets ã‚’å‚ç…§**

## ğŸ“Š é‹ç”¨ãƒ‘ã‚¿ãƒ¼ãƒ³

### ãƒ‘ã‚¿ãƒ¼ãƒ³ 1: Repository Secrets ã®ã¿ï¼ˆã‚·ãƒ³ãƒ—ãƒ«ï¼‰

**ãƒ¡ãƒªãƒƒãƒˆ**: è¨­å®šãŒç°¡å˜ã€ã™ãã«é–‹å§‹å¯èƒ½
**ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ**: ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ¬ãƒ™ãƒ«ãŒåŸºæœ¬çš„
**æ¨å¥¨**: å€‹äººé–‹ç™ºã€å­¦ç¿’ç›®çš„

### ãƒ‘ã‚¿ãƒ¼ãƒ³ 2: Environment Secretsï¼ˆæ¨å¥¨ï¼‰

**ãƒ¡ãƒªãƒƒãƒˆ**: é«˜ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã€æœ¬æ ¼é‹ç”¨å¯¾å¿œ
**ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ**: è¨­å®šãŒã‚„ã‚„è¤‡é›‘
**æ¨å¥¨**: 24 æ™‚é–“æœ¬ç•ªç¨¼åƒã€ãƒãƒ¼ãƒ é–‹ç™º

### ãƒ‘ã‚¿ãƒ¼ãƒ³ 3: ä¸¡æ–¹ä½µç”¨ï¼ˆæœ€å¼·ï¼‰

**Repository Secrets**: é–‹ç™ºãƒ»ãƒ†ã‚¹ãƒˆç”¨
**Environment Secrets**: æœ¬ç•ªç”¨
**ãƒ¡ãƒªãƒƒãƒˆ**: é–‹ç™ºåŠ¹ç‡ + æœ¬ç•ªå®‰å…¨æ€§
**æ¨å¥¨**: ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«é‹ç”¨

## ğŸ”§ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚ˆãã‚ã‚‹å•é¡Œ

#### **Environment not found**

```
ã‚¨ãƒ©ãƒ¼: Environment 'production' not found
è§£æ±º: Settings â†’ Environments ã§ productionç’°å¢ƒä½œæˆç¢ºèª
```

#### **Environment secrets access denied**

```
ã‚¨ãƒ©ãƒ¼: Cannot access environment secrets
è§£æ±º: Branch protection rules ç¢ºèªã€main ãƒ–ãƒ©ãƒ³ãƒã‹ã‚‰å®Ÿè¡Œ
```

#### **Secrets not loaded**

```
ã‚¨ãƒ©ãƒ¼: Environment variable not set
è§£æ±º: Environment secrets è¨­å®šç¢ºèªã€åå‰ã®ã‚¹ãƒšãƒ«ãƒã‚§ãƒƒã‚¯
```

### ãƒ‡ãƒãƒƒã‚°æ–¹æ³•

**Environment ç¢ºèª**:

```yaml
- name: ğŸ” Environment Info
  run: |
    echo "Environment: ${{ github.environment }}"
    echo "Ref: ${{ github.ref }}"
    echo "Actor: ${{ github.actor }}"
```

## ğŸ“ˆ ç›£è¦–ãƒ»é‹ç”¨

### Environment åˆ¥ãƒ­ã‚°ç¢ºèª

**GitHub Actions å®Ÿè¡Œå±¥æ­´**:

```
Actions â†’ Workflow runs â†’ Environment: production
```

**Environment åˆ¥çµ±è¨ˆ**:

```
Settings â†’ Environments â†’ production â†’ Deployments
```

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»

**å®šæœŸç¢ºèªé …ç›®**:

- Environment secrets ã®æ›´æ–°æ—¥
- ä¸è¦ãªã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ã®å‰Šé™¤
- Branch protection rules ã®ç¢ºèª
- å®Ÿè¡Œãƒ­ã‚°ã®ç•°å¸¸æ¤œçŸ¥

## ğŸ’¡ ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

### Secrets å‘½åè¦å‰‡

```
# Repository Secrets (é–‹ç™ºç”¨)
OPENAI_API_KEY_DEV
DISCORD_WEBHOOK_URL_TEST
SLACK_WEBHOOK_URL_DEV

# Environment Secrets (æœ¬ç•ªç”¨)
OPENAI_API_KEY
DISCORD_WEBHOOK_URL
SLACK_WEBHOOK_URL
```

### ç’°å¢ƒåˆ¥è¨­å®šä¾‹

```yaml
# é–‹ç™ºç’°å¢ƒ (Repository Secretsä½¿ç”¨)
- name: Development Test
  if: github.event_name == 'workflow_dispatch'
  run: python test.py
  env:
    API_KEY: ${{ secrets.OPENAI_API_KEY_DEV }}

# æœ¬ç•ªç’°å¢ƒ (Environment Secretsä½¿ç”¨)
- name: Production Deploy
  if: github.event_name == 'schedule'
  environment: production
  run: python deploy.py
  env:
    API_KEY: ${{ secrets.OPENAI_API_KEY }}
```

---

## ğŸ¯ å®Ÿè£…ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### âœ… Environment è¨­å®š

```
â–¡ GitHub â†’ Settings â†’ Environments
â–¡ Environmentå: production
â–¡ Branch protection: main only
â–¡ Environment secrets 3é …ç›®è¨­å®š
â–¡ ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ environment: production æŒ‡å®š
```

### âœ… Secrets è¨­å®š

```
â–¡ OPENAI_API_KEY (production)
â–¡ DISCORD_WEBHOOK_URL (production)
â–¡ YAHOO_FINANCE_API_KEY (production)
â–¡ ãƒ†ã‚¹ãƒˆå®Ÿè¡Œãƒ»å‹•ä½œç¢ºèª
```

### âœ… é‹ç”¨é–‹å§‹

```
â–¡ 24æ™‚é–“è‡ªå‹•ç¨¼åƒã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ç¢ºèª
â–¡ Discordé…ä¿¡ãƒ†ã‚¹ãƒˆæˆåŠŸ
â–¡ ãƒ­ã‚°ç›£è¦–ä½“åˆ¶ç¢ºç«‹
â–¡ ã‚¨ãƒ©ãƒ¼å¯¾å¿œãƒ•ãƒ­ãƒ¼ç¢ºèª
```

---

**ğŸŒŸ Environment Secrets è¨­å®šã§æœ€é«˜ãƒ¬ãƒ™ãƒ«ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚’å®Ÿç¾ï¼**

**æœ¬æ ¼çš„ãª 24 æ™‚é–“ç¨¼åƒã‚·ã‚¹ãƒ†ãƒ ã®å®Œæˆã§ã™ï¼** ğŸ”ğŸš€âœ¨
