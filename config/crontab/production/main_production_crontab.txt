# Exchange Analytics Production Crontab - çµ±åˆAIç›¸é–¢åˆ†æžã‚·ã‚¹ãƒ†ãƒ ç‰ˆ
# æœ€é«˜å“è³ªçµ±åˆã‚·ã‚¹ãƒ†ãƒ ï¼šé€šè²¨ç›¸é–¢åˆ†æž + ãƒ†ã‚¯ãƒ‹ã‚«ãƒ«æŒ‡æ¨™ + GPT-4åˆ†æž
SHELL=/bin/bash
PATH=/usr/local/bin:/usr/bin:/bin
HOME=/app

# ðŸŽ¯ çµ±åˆAIç›¸é–¢åˆ†æžã‚·ã‚¹ãƒ†ãƒ ï¼ˆãƒ¡ã‚¤ãƒ³ã‚·ã‚¹ãƒ†ãƒ ãƒ»2æ™‚é–“é–“éš”ã€æ‹¡å¼µå¸‚å ´æ™‚é–“8-2ï¼‰
0 8,10,12,14,16,18,20,22,0,2 * * 1-5 cd /app && export $(cat .env | grep -v '^#' | xargs) && timeout 180 python scripts/cron/integrated_ai_discord.py >> /app/logs/integrated_ai_cron.log 2>&1

# ðŸ“Š å€‹åˆ¥ãƒ†ã‚¯ãƒ‹ã‚«ãƒ«åˆ†æžãƒ¬ãƒãƒ¼ãƒˆï¼ˆ4æ™‚é–“é–“éš”ã€è£œåŠ©ã‚·ã‚¹ãƒ†ãƒ ã€æ‹¡å¼µå¸‚å ´æ™‚é–“ï¼‰
0 8,12,16,20,0 * * 1-5 cd /app && export $(cat .env | grep -v '^#' | xargs) && timeout 120 python scripts/cron/real_ai_discord_v2.py USD/JPY >> /app/logs/technical_ai_cron.log 2>&1

# ðŸ“ˆ Yahoo Finance åŸºæœ¬ãƒ‡ãƒ¼ã‚¿ç¢ºèªï¼ˆ1æ™‚é–“é–“éš”ã€ç›£è¦–ç”¨ã€æ‹¡å¼µå¸‚å ´æ™‚é–“ï¼‰
0 8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,0,1,2 * * 1-5 cd /app && export $(cat .env | grep -v '^#' | xargs) && timeout 60 python scripts/cron/yahoo_finance_discord.py --type rates --pairs "USD/JPY,EUR/USD,GBP/USD,EUR/JPY,GBP/JPY" >> /app/logs/yahoo_rates_cron.log 2>&1

# ðŸ” ã‚·ã‚¹ãƒ†ãƒ ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ï¼ˆ30åˆ†é–“éš”ï¼‰
*/30 * * * * cd /app && export $(cat .env | grep -v '^#' | xargs) && timeout 10 python scripts/monitoring/realtime_monitor.py --interval 1 --no-alerts >> /app/logs/health_cron.log 2>&1

# ðŸŒ APIã‚µãƒ¼ãƒãƒ¼ç¨¼åƒç¢ºèªï¼ˆ10åˆ†é–“éš”ï¼‰
*/10 * * * * timeout 5 curl -s http://localhost:8000/health >> /app/logs/api_health_cron.log 2>&1 || echo "$(date): API down" >> /app/logs/api_health_cron.log

# ðŸ“Š æ—¥æ¬¡çµ±åˆãƒ¬ãƒãƒ¼ãƒˆï¼ˆæ¯Žæ—¥18:00 JST = 09:00 UTCï¼‰
0 9 * * * cd /app && export $(cat .env | grep -v '^#' | xargs) && timeout 90 python scripts/cron/daily_report.py >> /app/logs/daily_cron.log 2>&1

# ðŸ“ˆ é€±æ¬¡çµ±è¨ˆãƒ»ãƒ¬ãƒãƒ¼ãƒˆï¼ˆæ¯Žé€±æœˆæ›œæ—¥ 9:00 JST = 00:00 UTCï¼‰
0 0 * * 1 cd /app && export $(cat .env | grep -v '^#' | xargs) && timeout 120 python scripts/cron/weekly_report.py >> /app/logs/weekly_cron.log 2>&1

# ðŸ—‘ï¸ ãƒ­ã‚°ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆæ¯Žæ—¥2:00 JST = 17:00 UTCï¼‰
0 17 * * * cd /app/logs && find . -name "*.log" -size +10M -exec gzip {} \; && find . -name "*.gz" -mtime +7 -delete >> /app/logs/cleanup.log 2>&1

# ðŸ” ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ç›£è¦–ï¼ˆ5åˆ†é–“éš”ï¼‰
*/5 * * * * [ -f /app/logs/integrated_ai_cron.log ] && tail -10 /app/logs/integrated_ai_cron.log | grep -i "error\|failed" && echo "$(date): Integrated AI Errors detected" >> /app/logs/error_alert.log

# ðŸ§ª çµ±åˆã‚·ã‚¹ãƒ†ãƒ æŽ¥ç¶šãƒ†ã‚¹ãƒˆï¼ˆ30åˆ†é–“éš”ï¼‰
*/30 * * * * cd /app && export $(cat .env | grep -v '^#' | xargs) && timeout 30 python scripts/cron/integrated_ai_discord.py --test >> /app/logs/integrated_test_cron.log 2>&1

# ðŸ”§ Yahoo Finance æŽ¥ç¶šãƒ†ã‚¹ãƒˆï¼ˆ1æ™‚é–“é–“éš”ï¼‰
0 * * * * cd /app && export $(cat .env | grep -v '^#' | xargs) && timeout 30 python tests/api/test_yahoo_finance.py --test connection >> /app/logs/yahoo_test_cron.log 2>&1
