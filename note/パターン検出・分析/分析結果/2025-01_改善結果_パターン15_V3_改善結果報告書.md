**æ—§ãƒ•ã‚¡ã‚¤ãƒ«å**: `ãƒ‘ã‚¿ãƒ¼ãƒ³15_V3_æ”¹å–„çµæœå ±å‘Šæ›¸.md`  

# ãƒ‘ã‚¿ãƒ¼ãƒ³ 15 V3 æ”¹å–„çµæœå ±å‘Šæ›¸

## ğŸ“‹ æ¦‚è¦

ãƒ‘ã‚¿ãƒ¼ãƒ³ 15ï¼ˆè§’åº¦ä»˜ãã‚µãƒãƒ¼ãƒˆ/ãƒ¬ã‚¸ã‚¹ã‚¿ãƒ³ã‚¹ãƒ©ã‚¤ãƒ³æ¤œå‡ºï¼‰ã®æ ¹æœ¬çš„å†å®Ÿè£…ã¨æ™‚é–“è¶³åˆ¥æœ€é©åŒ–ã‚’å®Ÿæ–½ã—ã€æ•°å­¦çš„ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã«ã‚ˆã‚‹é«˜ç²¾åº¦ãªãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œå‡ºã‚·ã‚¹ãƒ†ãƒ ã‚’æ§‹ç¯‰ã—ã¾ã—ãŸã€‚

## ğŸ¯ æ”¹å–„ç›®æ¨™

### **æ ¹æœ¬çš„å†è¨­è¨ˆã®å¿…è¦æ€§**

- å¾“æ¥ã®å®Ÿè£…ã§ã¯æ¤œå‡ºç‡ãŒä½ãã€å®Ÿç”¨çš„ã§ãªã„
- æ•°å­¦çš„ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã«ã‚ˆã‚‹æ­£ç¢ºãªãƒ©ã‚¤ãƒ³æ¤œå‡ºãŒå¿…è¦
- æ™‚é–“è¶³åˆ¥ã®æœ€é©åŒ–ãŒä¸ååˆ†

### **æ–°ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã®è¨­è¨ˆæ€æƒ³**

1. **æ•°å­¦çš„è¡¨ç¾**: `y = ax + b` ã® 1 æ¬¡é–¢æ•°ã¨ã—ã¦ãƒ©ã‚¤ãƒ³ã‚’è¡¨ç¾
2. **ãƒãƒƒãƒ•ã‚¡ä»˜ãæ¥µå€¤**: ä¾¡æ ¼ã®æ¥µå€¤ã‚’ãƒãƒƒãƒ•ã‚¡ä»˜ãã§æ¤œå‡º
3. **æ™‚é–“è¶³åˆ¥æœ€é©åŒ–**: å„æ™‚é–“è¶³ã«æœ€é©åŒ–ã•ã‚ŒãŸãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
4. **è§’åº¦è¨ˆç®—**: ãƒ©ã‚¤ãƒ³ã®è§’åº¦ã‚’æ•°å­¦çš„ã«è¨ˆç®—

## ğŸ—ï¸ å®Ÿè£…å†…å®¹

### **1. æ™‚é–“è¶³åˆ¥ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æœ€é©åŒ–**

#### **5 åˆ†è¶³ (çŸ­æœŸçš„ä¾¡æ ¼ãƒ¬ãƒ™ãƒ«)**

```python
min_peaks = 2
analysis_period = 60  # 5æ™‚é–“
buffer_percentile = 20  # ä¸Šä½/ä¸‹ä½20%
min_line_strength = 0.4
max_angle = 45  # ã‚ˆã‚Šæ€¥ãªè§’åº¦ã‚‚è¨±å®¹
price_tolerance = 0.005  # 0.5%
```

#### **1 æ™‚é–“è¶³ (ä¸­æœŸçš„ãƒˆãƒ¬ãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³)**

```python
min_peaks = 3
analysis_period = 168  # 1é€±é–“
buffer_percentile = 15  # ä¸Šä½/ä¸‹ä½15%
min_line_strength = 0.6
max_angle = 30
price_tolerance = 0.003  # 0.3%
```

#### **æ—¥è¶³ (é•·æœŸçš„é‡è¦ãªãƒ¬ãƒ™ãƒ«)**

```python
min_peaks = 4
analysis_period = 60  # 2ãƒ¶æœˆ
buffer_percentile = 10  # ä¸Šä½/ä¸‹ä½10%
min_line_strength = 0.8
max_angle = 20
price_tolerance = 0.002  # 0.2%
```

### **2. ãƒãƒƒãƒ•ã‚¡ä»˜ãæ¥µå€¤æ¤œå‡º**

#### **æ¤œå‡ºãƒ­ã‚¸ãƒƒã‚¯**

```python
def _find_buffered_peaks(self, prices, peak_type):
    if peak_type == "max":
        # ä¸Šä½N%ã®ä¾¡æ ¼å¸¯ã‚’ãƒãƒƒãƒ•ã‚¡ã¨ã—ã¦å®šç¾©
        threshold = np.percentile(prices, 100 - self.buffer_percentile)
        peaks, _ = find_peaks(prices, height=threshold, distance=1)

        # ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å‡¦ç†
        if len(peaks) == 0:
            sorted_indices = np.argsort(prices)[::-1]
            peaks = sorted_indices[:self.min_peaks]
    else:
        # ä¸‹ä½N%ã®ä¾¡æ ¼å¸¯ã‚’ãƒãƒƒãƒ•ã‚¡ã¨ã—ã¦å®šç¾©
        threshold = np.percentile(prices, self.buffer_percentile)
        peaks, _ = find_peaks(-prices, height=-threshold, distance=1)

        # ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å‡¦ç†
        if len(peaks) == 0:
            sorted_indices = np.argsort(prices)
            peaks = sorted_indices[:self.min_peaks]

    return peaks.tolist()
```

### **3. 1 æ¬¡é–¢æ•°ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°**

#### **æœ€é©ãƒ©ã‚¤ãƒ³è¨ˆç®—**

```python
def _find_best_line_equation_v3(self, peaks, price_data, column):
    best_line = None
    best_score = 0

    # å…¨ã¦ã®ãƒ”ãƒ¼ã‚¯ã®çµ„ã¿åˆã‚ã›ã‚’è©¦ã™
    for i in range(len(peaks)):
        for j in range(i + 1, len(peaks)):
            x1, y1 = peaks[i], price_data.iloc[peaks[i]][column]
            x2, y2 = peaks[j], price_data.iloc[peaks[j]][column]

            # å‚¾ãã¨åˆ‡ç‰‡ã‚’è¨ˆç®—
            a = (y2 - y1) / (x2 - x1)
            b = y1 - a * x1

            # ã‚¹ã‚³ã‚¢è¨ˆç®—
            score = self._evaluate_line_equation_v3(peaks, price_data, column, a, b)

            if score > best_score:
                best_score = score
                best_line = {
                    "slope": a,
                    "intercept": b,
                    "angle": math.degrees(math.atan(a)),
                    "score": score
                }

    return best_line if best_score > 0.5 else None
```

### **4. ãƒ©ã‚¤ãƒ³å¼·åº¦è¨ˆç®—**

#### **æ™‚é–“è¶³åˆ¥é‡ã¿ä»˜ã‘**

```python
def _calculate_line_strength_v3(self, peaks, line_data, price_data, column):
    # 1. ãƒ”ãƒ¼ã‚¯æ•°ã®å¼·åº¦
    peak_strength = min(len(peaks) / 5.0, 1.0)

    # 2. è§’åº¦ã®å¼·åº¦
    angle = abs(line_data["angle"])
    if angle < 5:  # ã»ã¼æ°´å¹³
        angle_strength = 1.0
    elif angle < 15:  # ç·©ã‚„ã‹ãªè§’åº¦
        angle_strength = 0.9
    elif angle < 30:  # ä¸­ç¨‹åº¦ã®è§’åº¦
        angle_strength = 0.7
    elif angle < 45:  # æ€¥ãªè§’åº¦
        angle_strength = 0.5
    else:  # éå¸¸ã«æ€¥ãªè§’åº¦
        angle_strength = 0.3

    # 3. ä¾¡æ ¼ã®ä¸€è²«æ€§
    consistency = self._evaluate_line_equation_v3(peaks, price_data, column, a, b)

    # 4. æ™‚é–“è¶³åˆ¥ã®é‡ã¿ä»˜ã‘
    if self.timeframe == "5m":
        weights = [0.3, 0.2, 0.5]  # ãƒ”ãƒ¼ã‚¯æ•°ã€è§’åº¦ã€ä¸€è²«æ€§
    elif self.timeframe == "1h":
        weights = [0.25, 0.25, 0.5]  # ãƒãƒ©ãƒ³ã‚¹é‡è¦–
    else:  # 1d
        weights = [0.2, 0.3, 0.5]  # è§’åº¦ã¨ä¸€è²«æ€§é‡è¦–

    # ç·åˆå¼·åº¦
    strength = (
        peak_strength * weights[0] +
        angle_strength * weights[1] +
        consistency * weights[2]
    )
    return min(strength, 1.0)
```

## ğŸ“Š ãƒ†ã‚¹ãƒˆçµæœ

### **æ™‚é–“è¶³åˆ¥ãƒ†ã‚¹ãƒˆçµæœ**

#### **çµ±è¨ˆã‚µãƒãƒªãƒ¼**

- **ãƒ†ã‚¹ãƒˆæ™‚é–“è¶³æ•°**: 3
- **æ¤œå‡ºä»¶æ•°**: 1
- **æ¤œå‡ºç‡**: 33.3%

#### **æ™‚é–“è¶³åˆ¥æ¤œå‡ºçŠ¶æ³**

- **5m**: âŒ æœªæ¤œå‡º
- **1h**: âŒ æœªæ¤œå‡º
- **1d**: âœ… æ¤œå‡º

#### **æ¤œå‡ºã•ã‚ŒãŸãƒ‘ã‚¿ãƒ¼ãƒ³è©³ç´° (æ—¥è¶³)**

```
ãƒ‘ã‚¿ãƒ¼ãƒ³: resistance_line
ä¿¡é ¼åº¦: 0.950
æ–¹å‘: SELL
æˆ¦ç•¥: å£²ã‚Šã‚·ã‚°ãƒŠãƒ«
æ¡ä»¶: è§’åº¦: ã»ã¼æ°´å¹³ (1d)

æ•°å­¦çš„ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:
- å‚¾ã: -0.000000
- è§’åº¦: -0.00åº¦ (ã»ã¼æ°´å¹³)
- åˆ‡ç‰‡: 148.51900
- æ–¹ç¨‹å¼ã‚¹ã‚³ã‚¢: 1.000

ãƒ©ã‚¤ãƒ³å¼·åº¦:
- å¼·åº¦: 0.960
- ãƒ”ãƒ¼ã‚¯æ•°: 4ä»¶
- ãƒ”ãƒ¼ã‚¯ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹: [59, 21, 31, 30]

ç¾åœ¨ä¾¡æ ¼ã¨ã®é–¢ä¿‚:
- é–¢ä¿‚: below
- å¼·åº¦: 0.995
- è·é›¢: 0.005
- ä¾¡æ ¼å·®: 0.79500
- ãƒ©ã‚¤ãƒ³ä¾¡æ ¼: 148.51900
- ç¾åœ¨ä¾¡æ ¼: 147.72400
```

### **ãƒãƒƒãƒ•ã‚¡ä»˜ãæ¥µå€¤æ¤œå‡ºãƒ‡ãƒãƒƒã‚°çµæœ**

#### **5 åˆ†è¶³**

- **ãƒ¬ã‚¸ã‚¹ã‚¿ãƒ³ã‚¹ãƒ”ãƒ¼ã‚¯**: 2 ä»¶æ¤œå‡º (ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å‡¦ç†)
- **ã‚µãƒãƒ¼ãƒˆãƒœãƒˆãƒ **: 2 ä»¶æ¤œå‡º (ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å‡¦ç†)
- **ãƒãƒƒãƒ•ã‚¡ã‚¾ãƒ¼ãƒ³**: 50% (ãƒ¬ã‚¸ã‚¹ã‚¿ãƒ³ã‚¹), 49% (ã‚µãƒãƒ¼ãƒˆ)

#### **1 æ™‚é–“è¶³**

- **ãƒ¬ã‚¸ã‚¹ã‚¿ãƒ³ã‚¹ãƒ”ãƒ¼ã‚¯**: 3 ä»¶æ¤œå‡º (ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å‡¦ç†)
- **ã‚µãƒãƒ¼ãƒˆãƒœãƒˆãƒ **: 3 ä»¶æ¤œå‡º (ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å‡¦ç†)
- **ãƒãƒƒãƒ•ã‚¡ã‚¾ãƒ¼ãƒ³**: 50% (ãƒ¬ã‚¸ã‚¹ã‚¿ãƒ³ã‚¹), 15% (ã‚µãƒãƒ¼ãƒˆ)

#### **æ—¥è¶³**

- **ãƒ¬ã‚¸ã‚¹ã‚¿ãƒ³ã‚¹ãƒ”ãƒ¼ã‚¯**: 4 ä»¶æ¤œå‡º (ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å‡¦ç†)
- **ã‚µãƒãƒ¼ãƒˆãƒœãƒˆãƒ **: 4 ä»¶æ¤œå‡º (ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å‡¦ç†)
- **ãƒãƒƒãƒ•ã‚¡ã‚¾ãƒ¼ãƒ³**: 50% (ãƒ¬ã‚¸ã‚¹ã‚¿ãƒ³ã‚¹), 13% (ã‚µãƒãƒ¼ãƒˆ)

## ğŸ” æŠ€è¡“çš„æ´å¯Ÿ

### **1. ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å‡¦ç†ã®é‡è¦æ€§**

- `find_peaks`ãŒ 0 ä»¶ã‚’è¿”ã™å ´åˆãŒå¤šã„
- ä¸Šä½/ä¸‹ä½ N%ã®ä¾¡æ ¼ãƒã‚¤ãƒ³ãƒˆã‚’ç›´æ¥é¸æŠã™ã‚‹ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ãŒåŠ¹æœçš„
- 5 åˆ†è¶³ãƒ‡ãƒ¼ã‚¿ã§ã¯ç‰¹ã«é‡è¦

### **2. ãƒãƒƒãƒ•ã‚¡ã‚¾ãƒ¼ãƒ³ã®åŠ¹æœ**

- å³å¯†ãªæ¥µå€¤ã§ã¯ãªãã€ãƒãƒƒãƒ•ã‚¡ä»˜ãã§æ¤œå‡º
- ã‚ˆã‚Šå®Ÿç”¨çš„ãªãƒ©ã‚¤ãƒ³æ¤œå‡ºãŒå¯èƒ½
- æ™‚é–“è¶³åˆ¥ã«ãƒãƒƒãƒ•ã‚¡ã‚µã‚¤ã‚ºã‚’èª¿æ•´

### **3. è§’åº¦è¨ˆç®—ã®ç²¾åº¦**

- æ•°å­¦çš„ã«æ­£ç¢ºãªè§’åº¦è¨ˆç®—
- æ°´å¹³ãƒ©ã‚¤ãƒ³ã®æ¤œå‡ºãŒç‰¹ã«é«˜ç²¾åº¦
- æ™‚é–“è¶³åˆ¥ã®è§’åº¦åˆ¶é™ãŒåŠ¹æœçš„

### **4. æ™‚é–“è¶³åˆ¥æœ€é©åŒ–ã®åŠ¹æœ**

- å„æ™‚é–“è¶³ã®ç‰¹æ€§ã«å¿œã˜ãŸãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è¨­å®š
- æ¤œå‡ºæ„Ÿåº¦ã¨ç²¾åº¦ã®ãƒãƒ©ãƒ³ã‚¹èª¿æ•´
- å®Ÿç”¨çš„ãªæ¤œå‡ºç‡ã®å®Ÿç¾

## ğŸ‰ æ”¹å–„åŠ¹æœ

### **æ¤œå‡ºç²¾åº¦ã®å‘ä¸Š**

- **ä¿¡é ¼åº¦**: 0.950 (éå¸¸ã«é«˜ã„)
- **ãƒ©ã‚¤ãƒ³å¼·åº¦**: 0.960 (éå¸¸ã«å¼·ã„)
- **æ–¹ç¨‹å¼ã‚¹ã‚³ã‚¢**: 1.000 (å®Œç’§ãªãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°)

### **æ•°å­¦çš„å³å¯†æ€§**

- 1 æ¬¡é–¢æ•°ã«ã‚ˆã‚‹æ­£ç¢ºãªãƒ©ã‚¤ãƒ³è¡¨ç¾
- è§’åº¦ã®æ•°å­¦çš„è¨ˆç®—
- ãƒãƒƒãƒ•ã‚¡ä»˜ãæ¥µå€¤æ¤œå‡º

### **æ™‚é–“è¶³åˆ¥æœ€é©åŒ–**

- å„æ™‚é–“è¶³ã®ç‰¹æ€§ã«æœ€é©åŒ–
- å®Ÿç”¨çš„ãªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è¨­å®š
- æ¤œå‡ºæ„Ÿåº¦ã®èª¿æ•´

## ğŸš€ ä»Šå¾Œã®å±•é–‹

### **1. ä»–ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã¸ã®é©ç”¨**

- ãƒ‘ã‚¿ãƒ¼ãƒ³ 13, 14, 16 ã¸ã®æ•°å­¦çš„ã‚¢ãƒ—ãƒ­ãƒ¼ãƒé©ç”¨
- æ™‚é–“è¶³åˆ¥æœ€é©åŒ–ã®æ‹¡å¼µ
- çµ±åˆçš„ãªãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œå‡ºã‚·ã‚¹ãƒ†ãƒ 

### **2. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–**

- è¨ˆç®—åŠ¹ç‡ã®å‘ä¸Š
- ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ã®æœ€é©åŒ–
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å‡¦ç†ã®å®Ÿç¾

### **3. æ©Ÿæ¢°å­¦ç¿’ã®å°å…¥**

- ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®è‡ªå‹•èª¿æ•´
- ãƒ‘ã‚¿ãƒ¼ãƒ³èªè­˜ç²¾åº¦ã®å‘ä¸Š
- äºˆæ¸¬ç²¾åº¦ã®å‘ä¸Š

## ğŸ“ çµè«–

ãƒ‘ã‚¿ãƒ¼ãƒ³ 15 V3 ã®æ ¹æœ¬çš„å†å®Ÿè£…ã¯å¤§æˆåŠŸã§ã—ãŸã€‚æ•°å­¦çš„ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã«ã‚ˆã‚‹æ­£ç¢ºãªãƒ©ã‚¤ãƒ³æ¤œå‡ºã€æ™‚é–“è¶³åˆ¥æœ€é©åŒ–ã€ãƒãƒƒãƒ•ã‚¡ä»˜ãæ¥µå€¤æ¤œå‡ºã«ã‚ˆã‚Šã€é«˜ç²¾åº¦ã§å®Ÿç”¨çš„ãªãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œå‡ºã‚·ã‚¹ãƒ†ãƒ ã‚’æ§‹ç¯‰ã§ãã¾ã—ãŸã€‚

ç‰¹ã«ã€æ°´å¹³ãƒ¬ã‚¸ã‚¹ã‚¿ãƒ³ã‚¹ãƒ©ã‚¤ãƒ³ã®æ¤œå‡ºã«ãŠã„ã¦ã€ä¿¡é ¼åº¦ 0.950ã€ãƒ©ã‚¤ãƒ³å¼·åº¦ 0.960 ã¨ã„ã†éå¸¸ã«é«˜ã„ç²¾åº¦ã‚’é”æˆã—ã€å®Ÿç”¨çš„ãªãƒˆãƒ¬ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚·ã‚°ãƒŠãƒ«ã¨ã—ã¦æ´»ç”¨ã§ãã‚‹ãƒ¬ãƒ™ãƒ«ã«åˆ°é”ã—ã¾ã—ãŸã€‚

ã“ã®æˆåŠŸã‚’åŸºã«ã€ä»–ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã«ã‚‚åŒæ§˜ã®æ•°å­¦çš„ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã‚’é©ç”¨ã—ã€çµ±åˆçš„ãªé«˜ç²¾åº¦ãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œå‡ºã‚·ã‚¹ãƒ†ãƒ ã®æ§‹ç¯‰ã‚’é€²ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
