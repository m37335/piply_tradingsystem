**æ—§ãƒ•ã‚¡ã‚¤ãƒ«å**: `notification_implementation_plan_2025.md`  

# ğŸ”§ Discord é€šçŸ¥ãƒ‘ã‚¿ãƒ¼ãƒ³å®Ÿè£…è¨ˆç”»ï¼ˆ2025 å¹´ 8 æœˆç‰ˆï¼‰

## ğŸ“‹ å®Ÿè£…æ¦‚è¦

`discord_notification_patterns_2025.md`ã§å®šç¾©ã—ãŸ 6 ã¤ã®é€šçŸ¥ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æŠ€è¡“çš„ã«å®Ÿè£…ã™ã‚‹ãŸã‚ã®è©³ç´°è¨ˆç”»ã§ã™ã€‚

---

## ğŸ—ï¸ **å®Ÿè£…ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£**

### 1. é€šçŸ¥ãƒ‘ã‚¿ãƒ¼ãƒ³åˆ¤å®šã‚¨ãƒ³ã‚¸ãƒ³

```
TechnicalIndicatorsAnalyzer
â”œâ”€â”€ ãƒãƒ«ãƒã‚¿ã‚¤ãƒ ãƒ•ãƒ¬ãƒ¼ãƒ åˆ†æ
â”œâ”€â”€ ãƒ‘ã‚¿ãƒ¼ãƒ³åˆ¤å®šãƒ­ã‚¸ãƒƒã‚¯
â”œâ”€â”€ å„ªå…ˆåº¦ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ 
â””â”€â”€ é€šçŸ¥ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç”Ÿæˆ
```

### 2. é€šçŸ¥ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ 

```
NotificationManager
â”œâ”€â”€ ãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œå‡º
â”œâ”€â”€ é‡è¤‡é˜²æ­¢
â”œâ”€â”€ å„ªå…ˆåº¦åˆ¶å¾¡
â””â”€â”€ Discordé€ä¿¡
```

---

## ğŸ“ **ãƒ•ã‚©ãƒ«ãƒ€æ§‹æˆè¨­è¨ˆ**

### **ç¾åœ¨ã®æ§‹é€ **

```
/app/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ infrastructure/
â”‚   â”‚   â”œâ”€â”€ analysis/
â”‚   â”‚   â”‚   â”œâ”€â”€ technical_indicators.py
â”‚   â”‚   â”‚   â””â”€â”€ currency_correlation_analyzer.py
â”‚   â”‚   â”œâ”€â”€ messaging/
â”‚   â”‚   â”‚   â””â”€â”€ discord_client.py
â”‚   â”‚   â””â”€â”€ external_apis/
â”‚   â”‚       â””â”€â”€ yahoo_finance_client.py
â”‚   â””â”€â”€ utils/
â”‚       â””â”€â”€ logging_config.py
â”œâ”€â”€ scripts/
â”‚   â””â”€â”€ cron/
â”‚       â”œâ”€â”€ integrated_ai_discord.py
â”‚       â””â”€â”€ real_ai_discord_v2.py
â””â”€â”€ note/
    â”œâ”€â”€ discord_notification_patterns_2025.md
    â””â”€â”€ notification_implementation_plan_2025.md
```

### **æ–°è¦è¿½åŠ äºˆå®šã®æ§‹é€ **

```
/app/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ infrastructure/
â”‚   â”‚   â”œâ”€â”€ analysis/
â”‚   â”‚   â”‚   â”œâ”€â”€ technical_indicators.py
â”‚   â”‚   â”‚   â”œâ”€â”€ currency_correlation_analyzer.py
â”‚   â”‚   â”‚   â”œâ”€â”€ notification_pattern_analyzer.py  â† æ–°è¦
â”‚   â”‚   â”‚   â””â”€â”€ pattern_detectors/                â† æ–°è¦ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
â”‚   â”‚   â”‚       â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚       â”œâ”€â”€ trend_reversal_detector.py    â† æ–°è¦
â”‚   â”‚   â”‚       â”œâ”€â”€ pullback_detector.py          â† æ–°è¦
â”‚   â”‚   â”‚       â”œâ”€â”€ divergence_detector.py        â† æ–°è¦
â”‚   â”‚   â”‚       â”œâ”€â”€ breakout_detector.py          â† æ–°è¦
â”‚   â”‚   â”‚       â”œâ”€â”€ rsi_battle_detector.py        â† æ–°è¦
â”‚   â”‚   â”‚       â””â”€â”€ composite_signal_detector.py  â† æ–°è¦
â”‚   â”‚   â”œâ”€â”€ messaging/
â”‚   â”‚   â”‚   â”œâ”€â”€ discord_client.py
â”‚   â”‚   â”‚   â”œâ”€â”€ notification_manager.py          â† æ–°è¦
â”‚   â”‚   â”‚   â””â”€â”€ templates/                       â† æ–°è¦ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
â”‚   â”‚   â”‚       â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚       â”œâ”€â”€ pattern_1_template.py        â† æ–°è¦
â”‚   â”‚   â”‚       â”œâ”€â”€ pattern_2_template.py        â† æ–°è¦
â”‚   â”‚   â”‚       â”œâ”€â”€ pattern_2_2_template.py      â† æ–°è¦
â”‚   â”‚   â”‚       â”œâ”€â”€ pattern_3_template.py        â† æ–°è¦
â”‚   â”‚   â”‚       â”œâ”€â”€ pattern_4_template.py        â† æ–°è¦
â”‚   â”‚   â”‚       â”œâ”€â”€ pattern_5_template.py        â† æ–°è¦
â”‚   â”‚   â”‚       â””â”€â”€ pattern_6_template.py        â† æ–°è¦
â”‚   â”‚   â””â”€â”€ external_apis/
â”‚   â”‚       â””â”€â”€ yahoo_finance_client.py
â”‚   â”œâ”€â”€ domain/
â”‚   â”‚   â”œâ”€â”€ entities/
â”‚   â”‚   â”‚   â””â”€â”€ notification_pattern.py          â† æ–°è¦
â”‚   â”‚   â””â”€â”€ value_objects/
â”‚   â”‚       â””â”€â”€ pattern_priority.py              â† æ–°è¦
â”‚   â””â”€â”€ utils/
â”‚       â”œâ”€â”€ logging_config.py
â”‚       â””â”€â”€ pattern_utils.py                     â† æ–°è¦
â”œâ”€â”€ scripts/
â”‚   â””â”€â”€ cron/
â”‚       â”œâ”€â”€ integrated_ai_discord.py
â”‚       â”œâ”€â”€ real_ai_discord_v2.py
â”‚       â””â”€â”€ notification_cron.py                 â† æ–°è¦
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ unit/
â”‚   â”‚   â”œâ”€â”€ test_technical_indicators.py
â”‚   â”‚   â”œâ”€â”€ test_notification_patterns.py        â† æ–°è¦
â”‚   â”‚   â””â”€â”€ test_pattern_detectors.py            â† æ–°è¦
â”‚   â””â”€â”€ integration/
â”‚       â”œâ”€â”€ test_notification_flow.py            â† æ–°è¦
â”‚       â””â”€â”€ test_discord_integration.py          â† æ–°è¦
â””â”€â”€ note/
    â”œâ”€â”€ discord_notification_patterns_2025.md
    â”œâ”€â”€ notification_implementation_plan_2025.md
    â””â”€â”€ folder_structure_2025.md                 â† æ–°è¦
```

### **ãƒ•ã‚¡ã‚¤ãƒ«è©³ç´°èª¬æ˜**

#### **æ–°è¦ã‚³ã‚¢ãƒ•ã‚¡ã‚¤ãƒ«**

- **`notification_pattern_analyzer.py`**: ãƒ¡ã‚¤ãƒ³ã®ãƒ‘ã‚¿ãƒ¼ãƒ³åˆ†æã‚¨ãƒ³ã‚¸ãƒ³
- **`notification_manager.py`**: é€šçŸ¥ç®¡ç†ãƒ»å„ªå…ˆåº¦åˆ¶å¾¡ã‚·ã‚¹ãƒ†ãƒ 
- **`notification_pattern.py`**: ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£å®šç¾©
- **`pattern_priority.py`**: å„ªå…ˆåº¦å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ

#### **ãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œå‡ºå™¨ï¼ˆDetectorsï¼‰**

- **`trend_reversal_detector.py`**: ãƒ‘ã‚¿ãƒ¼ãƒ³ 1ï¼ˆå¼·åŠ›ãªãƒˆãƒ¬ãƒ³ãƒ‰è»¢æ›ï¼‰
- **`pullback_detector.py`**: ãƒ‘ã‚¿ãƒ¼ãƒ³ 2ãƒ»2-2ï¼ˆæŠ¼ã—ç›®ãƒ»æˆ»ã‚Šå£²ã‚Šï¼‰
- **`divergence_detector.py`**: ãƒ‘ã‚¿ãƒ¼ãƒ³ 3ï¼ˆãƒ€ã‚¤ãƒãƒ¼ã‚¸ã‚§ãƒ³ã‚¹è­¦æˆ’ï¼‰
- **`breakout_detector.py`**: ãƒ‘ã‚¿ãƒ¼ãƒ³ 4ï¼ˆãƒ–ãƒ¬ã‚¤ã‚¯ã‚¢ã‚¦ãƒˆç‹™ã„ï¼‰
- **`rsi_battle_detector.py`**: ãƒ‘ã‚¿ãƒ¼ãƒ³ 5ï¼ˆRSI50 ãƒ©ã‚¤ãƒ³æ”»é˜²ï¼‰
- **`composite_signal_detector.py`**: ãƒ‘ã‚¿ãƒ¼ãƒ³ 6ï¼ˆè¤‡åˆã‚·ã‚°ãƒŠãƒ«ï¼‰

#### **é€šçŸ¥ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ**

- **`pattern_*_template.py`**: å„ãƒ‘ã‚¿ãƒ¼ãƒ³å°‚ç”¨ã® Discord é€šçŸ¥ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
- **`notification_cron.py`**: é€šçŸ¥å°‚ç”¨ã® cron ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

#### **ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«**

- **`test_notification_patterns.py`**: ãƒ‘ã‚¿ãƒ¼ãƒ³åˆ†æã®å˜ä½“ãƒ†ã‚¹ãƒˆ
- **`test_pattern_detectors.py`**: å„æ¤œå‡ºå™¨ã®å˜ä½“ãƒ†ã‚¹ãƒˆ
- **`test_notification_flow.py`**: é€šçŸ¥ãƒ•ãƒ­ãƒ¼ã®çµ±åˆãƒ†ã‚¹ãƒˆ

### **ãƒ•ã‚©ãƒ«ãƒ€æ§‹æˆã®åˆ©ç‚¹**

#### **1. ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æ€§**

- **å„ãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œå‡ºå™¨**: ç‹¬ç«‹ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã§ä¿å®ˆæ€§å‘ä¸Š
- **ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆåˆ†é›¢**: é€šçŸ¥å†…å®¹ã¨ãƒ­ã‚¸ãƒƒã‚¯ã®åˆ†é›¢
- **ãƒ†ã‚¹ãƒˆåˆ†é›¢**: å˜ä½“ãƒ»çµ±åˆãƒ†ã‚¹ãƒˆã®æ˜ç¢ºãªåˆ†é›¢

#### **2. æ‹¡å¼µæ€§**

- **æ–°ãƒ‘ã‚¿ãƒ¼ãƒ³è¿½åŠ **: `pattern_detectors/`ã«æ–°ãƒ•ã‚¡ã‚¤ãƒ«è¿½åŠ ã®ã¿
- **æ–°ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆè¿½åŠ **: `templates/`ã«æ–°ãƒ•ã‚¡ã‚¤ãƒ«è¿½åŠ ã®ã¿
- **è¨­å®šå¤‰æ›´**: å„ãƒ•ã‚¡ã‚¤ãƒ«ç‹¬ç«‹ã—ã¦ä¿®æ­£å¯èƒ½

#### **3. ä¿å®ˆæ€§**

- **è²¬ä»»åˆ†é›¢**: å„ãƒ•ã‚¡ã‚¤ãƒ«ãŒå˜ä¸€è²¬ä»»ã‚’æŒã¤
- **ä¾å­˜é–¢ä¿‚æ˜ç¢º**: import æ–‡ã§ä¾å­˜é–¢ä¿‚ãŒæ˜ç¢º
- **ãƒ‡ãƒãƒƒã‚°å®¹æ˜“**: å•é¡Œç®‡æ‰€ã®ç‰¹å®šãŒå®¹æ˜“

#### **4. ãƒ†ã‚¹ãƒˆå®¹æ˜“æ€§**

- **å˜ä½“ãƒ†ã‚¹ãƒˆ**: å„æ¤œå‡ºå™¨ã‚’ç‹¬ç«‹ã—ã¦ãƒ†ã‚¹ãƒˆ
- **çµ±åˆãƒ†ã‚¹ãƒˆ**: å…¨ä½“ãƒ•ãƒ­ãƒ¼ã‚’ãƒ†ã‚¹ãƒˆ
- **ãƒ¢ãƒƒã‚¯åŒ–**: ä¾å­˜é–¢ä¿‚ã®ãƒ¢ãƒƒã‚¯åŒ–ãŒå®¹æ˜“

---

## ğŸ“Š **å®Ÿè£…ãƒ•ã‚§ãƒ¼ã‚º**

### **ãƒ•ã‚§ãƒ¼ã‚º 1: åŸºç›¤å®Ÿè£…ï¼ˆå„ªå…ˆåº¦: é«˜ï¼‰**

#### 1.1 TechnicalIndicatorsAnalyzer æ‹¡å¼µ

```python
class NotificationPatternAnalyzer:
    def __init__(self):
        self.patterns = {
            'pattern_1': self._check_trend_reversal,
            'pattern_2': self._check_pullback_buy,
            'pattern_2_2': self._check_pullback_sell,
            'pattern_3': self._check_divergence,
            'pattern_4': self._check_breakout,
            'pattern_5': self._check_rsi_50_battle,
            'pattern_6': self._check_composite_signal
        }

    async def analyze_notification_patterns(self, currency_pair: str):
        """å…¨ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’åˆ†æã—ã¦é€šçŸ¥åˆ¤å®š"""
        results = {}
        for pattern_name, pattern_func in self.patterns.items():
            results[pattern_name] = await pattern_func(currency_pair)
        return results
```

#### 1.2 ãƒ‘ã‚¿ãƒ¼ãƒ³åˆ¤å®šãƒ¡ã‚½ãƒƒãƒ‰å®Ÿè£…

```python
async def _check_trend_reversal(self, currency_pair: str):
    """ãƒ‘ã‚¿ãƒ¼ãƒ³1: å¼·åŠ›ãªãƒˆãƒ¬ãƒ³ãƒ‰è»¢æ›ã‚·ã‚°ãƒŠãƒ«"""
    # D1, H4, H1, M5ã®å…¨æ™‚é–“è»¸ãƒ‡ãƒ¼ã‚¿å–å¾—
    # RSI > 70 + MACD ãƒ‡ãƒƒãƒ‰ã‚¯ãƒ­ã‚¹ + ãƒœãƒªãƒ³ã‚¸ãƒ£ãƒ¼ãƒãƒ³ãƒ‰ +2Ïƒ
    pass

async def _check_pullback_buy(self, currency_pair: str):
    """ãƒ‘ã‚¿ãƒ¼ãƒ³2: æŠ¼ã—ç›®è²·ã„ãƒãƒ£ãƒ³ã‚¹"""
    # D1: RSI 30-50 + MACDä¸Šæ˜‡ç¶™ç¶š
    # H4/H1: RSI 30-40 + ãƒœãƒªãƒ³ã‚¸ãƒ£ãƒ¼ãƒãƒ³ãƒ‰ -2Ïƒ
    pass

async def _check_pullback_sell(self, currency_pair: str):
    """ãƒ‘ã‚¿ãƒ¼ãƒ³2-2: æˆ»ã‚Šå£²ã‚Šãƒãƒ£ãƒ³ã‚¹"""
    # D1: RSI 50-70 + MACDä¸‹é™ç¶™ç¶š
    # H4/H1: RSI 60-70 + ãƒœãƒªãƒ³ã‚¸ãƒ£ãƒ¼ãƒãƒ³ãƒ‰ +2Ïƒ
    pass

async def _check_divergence(self, currency_pair: str):
    """ãƒ‘ã‚¿ãƒ¼ãƒ³3: ãƒ€ã‚¤ãƒãƒ¼ã‚¸ã‚§ãƒ³ã‚¹è­¦æˆ’"""
    # ä¾¡æ ¼æ–°é«˜å€¤ vs RSIå‰å›é«˜å€¤æœªé”
    # å…¨æ™‚é–“è»¸ã§ã®ä¾¡æ ¼ä¸Šæ˜‡ vs RSIä¸‹é™
    pass
```

### **ãƒ•ã‚§ãƒ¼ã‚º 2: é€šçŸ¥ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå®Ÿè£…ï¼ˆå„ªå…ˆåº¦: ä¸­ï¼‰**

#### 2.1 Discord é€šçŸ¥ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ

```python
class DiscordNotificationTemplates:
    @staticmethod
    def pattern_1_trend_reversal(data):
        return {
            "title": "ğŸš¨ å¼·åŠ›ãªå£²ã‚Šã‚·ã‚°ãƒŠãƒ«æ¤œå‡ºï¼",
            "description": f"ğŸ“Š {data['currency_pair']} å…¨æ™‚é–“è»¸ä¸€è‡´",
            "fields": [
                {"name": "ğŸ¯ ã‚¨ãƒ³ãƒˆãƒªãƒ¼", "value": f"{data['current_price']}", "inline": True},
                {"name": "ğŸ¯ åˆ©ç¢º", "value": f"{data['take_profit']}", "inline": True},
                {"name": "ğŸ¯ æåˆ‡ã‚Š", "value": f"{data['stop_loss']}", "inline": True}
            ],
            "color": 0xFF0000  # èµ¤è‰²ï¼ˆè­¦æˆ’ï¼‰
        }

    @staticmethod
    def pattern_2_pullback_buy(data):
        return {
            "title": "ğŸ“ˆ æŠ¼ã—ç›®è²·ã„ãƒãƒ£ãƒ³ã‚¹ï¼",
            "description": f"ğŸ“Š {data['currency_pair']} ãƒˆãƒ¬ãƒ³ãƒ‰ç¶™ç¶šä¸­",
            "fields": [
                {"name": "ğŸ¯ ã‚¨ãƒ³ãƒˆãƒªãƒ¼", "value": f"{data['current_price']}", "inline": True},
                {"name": "ğŸ¯ åˆ©ç¢º", "value": f"{data['take_profit']}", "inline": True},
                {"name": "ğŸ¯ æåˆ‡ã‚Š", "value": f"{data['stop_loss']}", "inline": True}
            ],
            "color": 0x00FF00  # ç·‘è‰²ï¼ˆè²·ã„ï¼‰
        }
```

### **ãƒ•ã‚§ãƒ¼ã‚º 3: é€šçŸ¥ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ å®Ÿè£…ï¼ˆå„ªå…ˆåº¦: ä¸­ï¼‰**

#### 3.1 NotificationManager

```python
class NotificationManager:
    def __init__(self):
        self.pattern_analyzer = NotificationPatternAnalyzer()
        self.discord_client = DiscordClient()
        self.notification_history = {}
        self.priority_weights = {
            'pattern_1': 100,  # æœ€é«˜å„ªå…ˆåº¦
            'pattern_6': 90,   # é«˜å„ªå…ˆåº¦
            'pattern_2': 70,   # ä¸­å„ªå…ˆåº¦
            'pattern_2_2': 70, # ä¸­å„ªå…ˆåº¦
            'pattern_4': 70,   # ä¸­å„ªå…ˆåº¦
            'pattern_3': 70,   # ä¸­å„ªå…ˆåº¦
            'pattern_5': 50    # ä½å„ªå…ˆåº¦
        }

    async def process_notifications(self, currency_pair: str):
        """é€šçŸ¥ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’å‡¦ç†ã—ã¦Discordé€ä¿¡"""
        # 1. ãƒ‘ã‚¿ãƒ¼ãƒ³åˆ†æ
        patterns = await self.pattern_analyzer.analyze_notification_patterns(currency_pair)

        # 2. å„ªå…ˆåº¦ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
        high_priority_patterns = self._filter_high_priority(patterns)

        # 3. é‡è¤‡ãƒã‚§ãƒƒã‚¯
        new_patterns = self._check_duplicates(high_priority_patterns)

        # 4. Discordé€ä¿¡
        for pattern in new_patterns:
            await self._send_discord_notification(pattern)
```

---

## ğŸ”§ **æŠ€è¡“çš„å®Ÿè£…è©³ç´°**

### **1. ãƒãƒ«ãƒã‚¿ã‚¤ãƒ ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿å–å¾—**

```python
async def get_multi_timeframe_data(self, currency_pair: str):
    """å…¨æ™‚é–“è»¸ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä¸€æ‹¬å–å¾—"""
    timeframes = {
        'D1': '1d',
        'H4': '4h',
        'H1': '1h',
        'M5': '5m'
    }

    data = {}
    for tf_name, tf_interval in timeframes.items():
        # ååˆ†ãªãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒˆã‚’å–å¾—ï¼ˆãƒ†ã‚¯ãƒ‹ã‚«ãƒ«æŒ‡æ¨™è¨ˆç®—ç”¨ï¼‰
        period_map = {
            'D1': '3mo',   # 3ãƒ¶æœˆåˆ†
            'H4': '1mo',   # 1ãƒ¶æœˆåˆ†
            'H1': '1wk',   # 1é€±é–“åˆ†
            'M5': '1d'     # 1æ—¥åˆ†
        }

        hist_data = await self.yahoo_client.get_historical_data(
            currency_pair,
            period=period_map[tf_name],
            interval=tf_interval
        )

        if hist_data is not None:
            # ãƒ†ã‚¯ãƒ‹ã‚«ãƒ«æŒ‡æ¨™è¨ˆç®—
            indicators = await self.technical_analyzer.calculate_all_indicators(
                hist_data, tf_name
            )
            data[tf_name] = {
                'price_data': hist_data,
                'indicators': indicators
            }

    return data
```

### **2. ãƒ‘ã‚¿ãƒ¼ãƒ³åˆ¤å®šãƒ­ã‚¸ãƒƒã‚¯**

```python
def _check_trend_reversal_conditions(self, data):
    """ãƒ‘ã‚¿ãƒ¼ãƒ³1ã®æ¡ä»¶åˆ¤å®š"""
    conditions = {
        'D1': {
            'rsi_overbought': data['D1']['indicators']['rsi']['current_value'] > 70,
            'macd_dead_cross': self._check_macd_dead_cross(data['D1']['indicators']['macd']),
            'price_high': data['D1']['price_data']['Close'].iloc[-1] > data['D1']['price_data']['Close'].iloc[-2]
        },
        'H4': {
            'rsi_overbought': data['H4']['indicators']['rsi']['current_value'] > 70,
            'bb_upper_touch': self._check_bb_upper_touch(data['H4']['indicators']['bollinger_bands'])
        },
        'H1': {
            'rsi_overbought': data['H1']['indicators']['rsi']['current_value'] > 70,
            'bb_upper_touch': self._check_bb_upper_touch(data['H1']['indicators']['bollinger_bands'])
        },
        'M5': {
            'rsi_overbought': data['M5']['indicators']['rsi']['current_value'] > 70,
            'wick_formation': self._check_wick_formation(data['M5']['price_data'])
        }
    }

    # å…¨æ™‚é–“è»¸ã®æ¡ä»¶ä¸€è‡´ã‚’ãƒã‚§ãƒƒã‚¯
    return self._check_all_timeframe_conditions(conditions)
```

### **3. ãƒ€ã‚¤ãƒãƒ¼ã‚¸ã‚§ãƒ³ã‚¹æ¤œå‡º**

```python
def _detect_divergence(self, price_data, rsi_data, lookback_periods=10):
    """ä¾¡æ ¼ã¨RSIã®ãƒ€ã‚¤ãƒãƒ¼ã‚¸ã‚§ãƒ³ã‚¹æ¤œå‡º"""
    # ä¾¡æ ¼ã®é«˜å€¤ãƒ»å®‰å€¤ã‚’æ¤œå‡º
    price_highs = self._find_peaks(price_data['High'], lookback_periods)
    price_lows = self._find_peaks(-price_data['Low'], lookback_periods)

    # RSIã®é«˜å€¤ãƒ»å®‰å€¤ã‚’æ¤œå‡º
    rsi_highs = self._find_peaks(rsi_data, lookback_periods)
    rsi_lows = self._find_peaks(-rsi_data, lookback_periods)

    # ãƒ€ã‚¤ãƒãƒ¼ã‚¸ã‚§ãƒ³ã‚¹åˆ¤å®š
    bearish_divergence = self._check_bearish_divergence(price_highs, rsi_highs)
    bullish_divergence = self._check_bullish_divergence(price_lows, rsi_lows)

    return {
        'bearish': bearish_divergence,
        'bullish': bullish_divergence
    }
```

---

## ğŸ“… **å®Ÿè£…ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«**

### **Week 1: åŸºç›¤å®Ÿè£…**

- [ ] ãƒ•ã‚©ãƒ«ãƒ€æ§‹æˆä½œæˆ
  - [ ] `src/infrastructure/analysis/pattern_detectors/` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä½œæˆ
  - [ ] `src/infrastructure/messaging/templates/` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä½œæˆ
  - [ ] `src/domain/entities/notification_pattern.py` ä½œæˆ
  - [ ] `src/domain/value_objects/pattern_priority.py` ä½œæˆ
  - [ ] `src/utils/pattern_utils.py` ä½œæˆ
- [ ] NotificationPatternAnalyzer ã‚¯ãƒ©ã‚¹ä½œæˆ
- [ ] ãƒãƒ«ãƒã‚¿ã‚¤ãƒ ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿å–å¾—æ©Ÿèƒ½
- [ ] åŸºæœ¬çš„ãªãƒ‘ã‚¿ãƒ¼ãƒ³åˆ¤å®šãƒ­ã‚¸ãƒƒã‚¯

### **Week 2: ãƒ‘ã‚¿ãƒ¼ãƒ³å®Ÿè£…**

- [ ] ãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œå‡ºå™¨ï¼ˆDetectorsï¼‰å®Ÿè£…
  - [ ] `trend_reversal_detector.py` (ãƒ‘ã‚¿ãƒ¼ãƒ³ 1)
  - [ ] `pullback_detector.py` (ãƒ‘ã‚¿ãƒ¼ãƒ³ 2ãƒ»2-2)
  - [ ] `divergence_detector.py` (ãƒ‘ã‚¿ãƒ¼ãƒ³ 3)
  - [ ] `breakout_detector.py` (ãƒ‘ã‚¿ãƒ¼ãƒ³ 4)
  - [ ] `rsi_battle_detector.py` (ãƒ‘ã‚¿ãƒ¼ãƒ³ 5)
  - [ ] `composite_signal_detector.py` (ãƒ‘ã‚¿ãƒ¼ãƒ³ 6)
- [ ] å„ãƒ‘ã‚¿ãƒ¼ãƒ³ã®å˜ä½“ãƒ†ã‚¹ãƒˆä½œæˆ

### **Week 3: é€šçŸ¥ã‚·ã‚¹ãƒ†ãƒ **

- [ ] Discord é€šçŸ¥ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå®Ÿè£…
  - [ ] `pattern_1_template.py` (ãƒˆãƒ¬ãƒ³ãƒ‰è»¢æ›)
  - [ ] `pattern_2_template.py` (æŠ¼ã—ç›®è²·ã„)
  - [ ] `pattern_2_2_template.py` (æˆ»ã‚Šå£²ã‚Š)
  - [ ] `pattern_3_template.py` (ãƒ€ã‚¤ãƒãƒ¼ã‚¸ã‚§ãƒ³ã‚¹)
  - [ ] `pattern_4_template.py` (ãƒ–ãƒ¬ã‚¤ã‚¯ã‚¢ã‚¦ãƒˆ)
  - [ ] `pattern_5_template.py` (RSI50 æ”»é˜²)
  - [ ] `pattern_6_template.py` (è¤‡åˆã‚·ã‚°ãƒŠãƒ«)
- [ ] NotificationManager å®Ÿè£…
- [ ] å„ªå…ˆåº¦ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ 
- [ ] `notification_cron.py` ä½œæˆ

### **Week 4: ãƒ†ã‚¹ãƒˆãƒ»æœ€é©åŒ–**

- [ ] çµ±åˆãƒ†ã‚¹ãƒˆå®Ÿè£…
  - [ ] `test_notification_flow.py` (é€šçŸ¥ãƒ•ãƒ­ãƒ¼çµ±åˆãƒ†ã‚¹ãƒˆ)
  - [ ] `test_discord_integration.py` (Discord çµ±åˆãƒ†ã‚¹ãƒˆ)
- [ ] å…¨ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
- [ ] é€šçŸ¥ç²¾åº¦ã®æ¸¬å®šãƒ»åˆ†æ
- [ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–
- [ ] ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ›´æ–°
  - [ ] `folder_structure_2025.md` ä½œæˆ

---

## ğŸ¯ **å®Ÿè£…å„ªå…ˆé †ä½**

### **Phase 1: é«˜å„ªå…ˆåº¦ï¼ˆå³åº§å®Ÿè£…ï¼‰**

1. **ãƒ‘ã‚¿ãƒ¼ãƒ³ 1**: å¼·åŠ›ãªãƒˆãƒ¬ãƒ³ãƒ‰è»¢æ›ã‚·ã‚°ãƒŠãƒ«
2. **ãƒ‘ã‚¿ãƒ¼ãƒ³ 6**: è¤‡åˆã‚·ã‚°ãƒŠãƒ«å¼·åŒ–
3. **åŸºç›¤ã‚·ã‚¹ãƒ†ãƒ **: NotificationPatternAnalyzer

### **Phase 2: ä¸­å„ªå…ˆåº¦ï¼ˆ1-2 é€±é–“å¾Œï¼‰**

4. **ãƒ‘ã‚¿ãƒ¼ãƒ³ 2**: æŠ¼ã—ç›®è²·ã„ãƒãƒ£ãƒ³ã‚¹
5. **ãƒ‘ã‚¿ãƒ¼ãƒ³ 2-2**: æˆ»ã‚Šå£²ã‚Šãƒãƒ£ãƒ³ã‚¹
6. **ãƒ‘ã‚¿ãƒ¼ãƒ³ 4**: ãƒ–ãƒ¬ã‚¤ã‚¯ã‚¢ã‚¦ãƒˆç‹™ã„
7. **ãƒ‘ã‚¿ãƒ¼ãƒ³ 3**: ãƒ€ã‚¤ãƒãƒ¼ã‚¸ã‚§ãƒ³ã‚¹è­¦æˆ’

### **Phase 3: ä½å„ªå…ˆåº¦ï¼ˆ3-4 é€±é–“å¾Œï¼‰**

8. **ãƒ‘ã‚¿ãƒ¼ãƒ³ 5**: RSI50 ãƒ©ã‚¤ãƒ³æ”»é˜²
9. **é«˜åº¦ãªæ©Ÿèƒ½**: æ©Ÿæ¢°å­¦ç¿’ã«ã‚ˆã‚‹ç²¾åº¦å‘ä¸Š

---

## ğŸ“Š **æœŸå¾…åŠ¹æœ**

### **çŸ­æœŸçš„åŠ¹æœ**

- **é€šçŸ¥ç²¾åº¦**: ãƒãƒ«ãƒã‚¿ã‚¤ãƒ ãƒ•ãƒ¬ãƒ¼ãƒ ã«ã‚ˆã‚‹ä¿¡é ¼åº¦å‘ä¸Š
- **ã‚¨ãƒ³ãƒˆãƒªãƒ¼ã‚¿ã‚¤ãƒŸãƒ³ã‚°**: ä¸‹ä½è¶³ã«ã‚ˆã‚‹ç²¾åº¦å‘ä¸Š
- **ãƒªã‚¹ã‚¯ç®¡ç†**: ãƒ€ã‚¤ãƒãƒ¼ã‚¸ã‚§ãƒ³ã‚¹æ¤œå‡ºã«ã‚ˆã‚‹è­¦æˆ’

### **é•·æœŸçš„åŠ¹æœ**

- **ãƒˆãƒ¬ãƒ¼ãƒ‰æˆç¸¾**: ä½“ç³»çš„ãªåˆ†æã«ã‚ˆã‚‹å‹ç‡å‘ä¸Š
- **å­¦ç¿’åŠ¹æœ**: ãƒ‘ã‚¿ãƒ¼ãƒ³èªè­˜èƒ½åŠ›ã®å‘ä¸Š
- **ã‚·ã‚¹ãƒ†ãƒ å®‰å®šæ€§**: è‡ªå‹•åŒ–ã«ã‚ˆã‚‹ä¸€è²«æ€§ç¢ºä¿

---

_æœ¬å®Ÿè£…è¨ˆç”»ã¯ã€å¸‚å ´çŠ¶æ³ã¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã«å¿œã˜ã¦ç¶™ç¶šçš„ã«èª¿æ•´ã•ã‚Œã¾ã™ã€‚_
