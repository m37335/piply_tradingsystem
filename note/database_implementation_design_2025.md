# ğŸ—„ï¸ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å®Ÿè£…ãƒ»5 åˆ†ãŠããƒ‡ãƒ¼ã‚¿å–å¾—ã‚·ã‚¹ãƒ†ãƒ è¨­è¨ˆæ›¸

## ğŸ“‹ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

### ğŸ¯ **ç›®çš„**

- **USD/JPY ç‰¹åŒ–**ã® 5 åˆ†ãŠããƒ‡ãƒ¼ã‚¿å–å¾—ã‚·ã‚¹ãƒ†ãƒ 
- **API å‘¼ã³å‡ºã—æœ€å°åŒ–**ã«ã‚ˆã‚‹ã‚³ã‚¹ãƒˆå‰Šæ¸›
- **æ—¢å­˜é€šçŸ¥ã‚·ã‚¹ãƒ†ãƒ **ã¨ã®å®Œå…¨çµ±åˆ
- **ãƒ†ã‚¯ãƒ‹ã‚«ãƒ«æŒ‡æ¨™**ã®è‡ªå‹•è¨ˆç®—ãƒ»ä¿å­˜

### ğŸ“Š **è¨­è¨ˆæ–¹é‡**

- **é€šè²¨ãƒšã‚¢**: USD/JPY ã®ã¿ï¼ˆAPI å‘¼ã³å‡ºã—å‰Šæ¸›ï¼‰
- **å–å¾—é–“éš”**: 5 åˆ†é–“éš”ï¼ˆ288 å›/æ—¥ï¼‰
- **ãƒ‡ãƒ¼ã‚¿ä¿å­˜**: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ  DB ä¿å­˜
- **é€šçŸ¥é€£æº**: æ—¢å­˜ 6 ãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œå‡ºã‚·ã‚¹ãƒ†ãƒ ã¨çµ±åˆ

## ğŸ—ï¸ ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### ğŸ“ˆ **ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Yahoo Finance â”‚â”€â”€â”€â–ºâ”‚   Data Fetcher  â”‚â”€â”€â”€â–ºâ”‚   Database      â”‚
â”‚   API (USD/JPY) â”‚    â”‚   (5åˆ†é–“éš”)     â”‚    â”‚   (SQLite/PostgreSQL) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                       â”‚ Technical       â”‚
                       â”‚ Indicators      â”‚
                       â”‚ Calculator      â”‚
                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                       â”‚ Pattern         â”‚â”€â”€â”€â–ºâ”‚ Discord         â”‚
                       â”‚ Detector        â”‚    â”‚ Notification    â”‚
                       â”‚ (6ãƒ‘ã‚¿ãƒ¼ãƒ³)     â”‚    â”‚ System          â”‚
                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ”„ **å®Ÿè¡Œã‚µã‚¤ã‚¯ãƒ«**

```
1. 5åˆ†é–“éš”ãƒ‡ãƒ¼ã‚¿å–å¾—
   â†“
2. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ä¿å­˜
   â†“
3. ãƒ†ã‚¯ãƒ‹ã‚«ãƒ«æŒ‡æ¨™è¨ˆç®—
   â†“
4. ãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œå‡ºå®Ÿè¡Œ
   â†“
5. é€šçŸ¥åˆ¤å®šãƒ»é€ä¿¡
   â†“
6. å±¥æ­´ç®¡ç†
```

## ğŸ—„ï¸ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆ

### ğŸ“Š **ãƒ†ãƒ¼ãƒ–ãƒ«æ§‹æˆ**

#### 1. **ä¾¡æ ¼ãƒ‡ãƒ¼ã‚¿ãƒ†ãƒ¼ãƒ–ãƒ«** (`price_data`)

```sql
CREATE TABLE price_data (
    id BIGSERIAL PRIMARY KEY,
    currency_pair VARCHAR(10) NOT NULL DEFAULT 'USD/JPY',
    timestamp TIMESTAMP WITH TIME ZONE NOT NULL,
    open_price DECIMAL(10,5) NOT NULL,
    high_price DECIMAL(10,5) NOT NULL,
    low_price DECIMAL(10,5) NOT NULL,
    close_price DECIMAL(10,5) NOT NULL,
    volume BIGINT,
    data_source VARCHAR(50) DEFAULT 'Yahoo Finance',
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),

    -- ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
    CONSTRAINT idx_price_data_currency_timestamp UNIQUE (currency_pair, timestamp),
    INDEX idx_price_data_timestamp (timestamp),
    INDEX idx_price_data_currency (currency_pair)
);

-- ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³åŒ–ï¼ˆæœˆåˆ¥ï¼‰
CREATE TABLE price_data_2025_01 PARTITION OF price_data
FOR VALUES FROM ('2025-01-01') TO ('2025-02-01');

CREATE TABLE price_data_2025_02 PARTITION OF price_data
FOR VALUES FROM ('2025-02-01') TO ('2025-03-01');
```

#### 2. **ãƒ†ã‚¯ãƒ‹ã‚«ãƒ«æŒ‡æ¨™ãƒ†ãƒ¼ãƒ–ãƒ«** (`technical_indicators`)

```sql
CREATE TABLE technical_indicators (
    id BIGSERIAL PRIMARY KEY,
    currency_pair VARCHAR(10) NOT NULL DEFAULT 'USD/JPY',
    timestamp TIMESTAMP WITH TIME ZONE NOT NULL,
    indicator_type VARCHAR(20) NOT NULL,  -- RSI, MACD, BB, SMA, EMA
    timeframe VARCHAR(10) NOT NULL,       -- M5, M15, H1, H4, D1
    value DECIMAL(15,8) NOT NULL,
    additional_data JSONB,                -- MACD histogram, BB bandsç­‰
    parameters JSONB,                     -- è¨ˆç®—ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆæœŸé–“ç­‰ï¼‰
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),

    -- ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
    CONSTRAINT idx_tech_indicators_unique UNIQUE (currency_pair, timestamp, indicator_type, timeframe),
    INDEX idx_tech_indicators_timestamp (timestamp),
    INDEX idx_tech_indicators_type (indicator_type),
    INDEX idx_tech_indicators_timeframe (timeframe)
);
```

#### 3. **ãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œå‡ºçµæœãƒ†ãƒ¼ãƒ–ãƒ«** (`pattern_detections`)

```sql
CREATE TABLE pattern_detections (
    id BIGSERIAL PRIMARY KEY,
    currency_pair VARCHAR(10) NOT NULL DEFAULT 'USD/JPY',
    pattern_number INTEGER NOT NULL,      -- 1-6
    pattern_name VARCHAR(100) NOT NULL,
    priority INTEGER NOT NULL,            -- 10-100
    confidence_score DECIMAL(3,2) NOT NULL, -- 0.00-1.00
    detection_time TIMESTAMP WITH TIME ZONE NOT NULL,
    notification_title VARCHAR(200),
    notification_color VARCHAR(10),
    strategy TEXT,
    entry_condition TEXT,
    take_profit VARCHAR(50),
    stop_loss VARCHAR(50),
    description TEXT,
    conditions_met JSONB,                 -- å„æ™‚é–“è»¸ã®æ¡ä»¶é”æˆçŠ¶æ³
    technical_data JSONB,                 -- æ¤œå‡ºæ™‚ã®ãƒ†ã‚¯ãƒ‹ã‚«ãƒ«ãƒ‡ãƒ¼ã‚¿
    notification_sent BOOLEAN DEFAULT FALSE,
    discord_message_id VARCHAR(50),
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),

    -- ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
    INDEX idx_pattern_detections_time (detection_time),
    INDEX idx_pattern_detections_pattern (pattern_number),
    INDEX idx_pattern_detections_priority (priority),
    INDEX idx_pattern_detections_notification (notification_sent)
);
```

#### 4. **ãƒ‡ãƒ¼ã‚¿å–å¾—å±¥æ­´ãƒ†ãƒ¼ãƒ–ãƒ«** (`data_fetch_history`)

```sql
CREATE TABLE data_fetch_history (
    id BIGSERIAL PRIMARY KEY,
    currency_pair VARCHAR(10) NOT NULL DEFAULT 'USD/JPY',
    fetch_time TIMESTAMP WITH TIME ZONE NOT NULL,
    data_source VARCHAR(50) NOT NULL,
    success BOOLEAN NOT NULL,
    response_time_ms INTEGER,
    data_count INTEGER,                   -- å–å¾—ãƒ‡ãƒ¼ã‚¿æ•°
    error_message TEXT,
    retry_count INTEGER DEFAULT 0,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),

    -- ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
    INDEX idx_fetch_history_time (fetch_time),
    INDEX idx_fetch_history_success (success),
    INDEX idx_fetch_history_source (data_source)
);
```

#### 5. **ã‚·ã‚¹ãƒ†ãƒ è¨­å®šãƒ†ãƒ¼ãƒ–ãƒ«** (`system_config`)

```sql
CREATE TABLE system_config (
    id BIGSERIAL PRIMARY KEY,
    config_key VARCHAR(100) NOT NULL UNIQUE,
    config_value TEXT NOT NULL,
    config_type VARCHAR(20) NOT NULL,     -- string, integer, float, boolean, json
    description TEXT,
    is_active BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- åˆæœŸè¨­å®šãƒ‡ãƒ¼ã‚¿
INSERT INTO system_config (config_key, config_value, config_type, description) VALUES
('data_fetch_interval_minutes', '5', 'integer', 'ãƒ‡ãƒ¼ã‚¿å–å¾—é–“éš”ï¼ˆåˆ†ï¼‰'),
('currency_pairs', '["USD/JPY"]', 'json', 'å–å¾—å¯¾è±¡é€šè²¨ãƒšã‚¢'),
('yahoo_finance_retry_count', '3', 'integer', 'Yahoo Finance API ãƒªãƒˆãƒ©ã‚¤å›æ•°'),
('yahoo_finance_retry_delay', '2.0', 'float', 'ãƒªãƒˆãƒ©ã‚¤é–“éš”ï¼ˆç§’ï¼‰'),
('technical_indicators_enabled', 'true', 'boolean', 'ãƒ†ã‚¯ãƒ‹ã‚«ãƒ«æŒ‡æ¨™è¨ˆç®—æœ‰åŠ¹åŒ–'),
('pattern_detection_enabled', 'true', 'boolean', 'ãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œå‡ºæœ‰åŠ¹åŒ–'),
('notification_enabled', 'true', 'boolean', 'é€šçŸ¥æ©Ÿèƒ½æœ‰åŠ¹åŒ–'),
('data_retention_days', '90', 'integer', 'ãƒ‡ãƒ¼ã‚¿ä¿æŒæœŸé–“ï¼ˆæ—¥ï¼‰');
```

### ğŸ”§ **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ç®¡ç†**

#### ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³æˆ¦ç•¥

```sql
-- æœˆåˆ¥ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ä½œæˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ
CREATE OR REPLACE FUNCTION create_monthly_partition(table_name TEXT, year_month TEXT)
RETURNS VOID AS $$
BEGIN
    EXECUTE format('
        CREATE TABLE IF NOT EXISTS %I_%s PARTITION OF %I
        FOR VALUES FROM (%L) TO (%L)
    ',
    table_name, year_month, table_name,
    year_month || '-01',
    (year_month || '-01')::date + INTERVAL '1 month'
    );
END;
$$ LANGUAGE plpgsql;

-- è‡ªå‹•ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ä½œæˆï¼ˆæœˆæ¬¡å®Ÿè¡Œï¼‰
SELECT create_monthly_partition('price_data', '2025_01');
SELECT create_monthly_partition('price_data', '2025_02');
```

#### ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—

```sql
-- å¤ã„ãƒ‡ãƒ¼ã‚¿å‰Šé™¤ï¼ˆ90æ—¥ä»¥ä¸Šå‰ï¼‰
DELETE FROM price_data
WHERE timestamp < NOW() - INTERVAL '90 days';

DELETE FROM technical_indicators
WHERE timestamp < NOW() - INTERVAL '90 days';

DELETE FROM pattern_detections
WHERE detection_time < NOW() - INTERVAL '90 days';

DELETE FROM data_fetch_history
WHERE fetch_time < NOW() - INTERVAL '30 days';
```

## ğŸ”„ ãƒ‡ãƒ¼ã‚¿å–å¾—ã‚·ã‚¹ãƒ†ãƒ 

### ğŸ“¡ **Yahoo Finance ãƒ‡ãƒ¼ã‚¿å–å¾—**

#### ãƒ‡ãƒ¼ã‚¿å–å¾—ã‚¯ãƒ©ã‚¹

```python
class USDJPYDataFetcher:
    """USD/JPYç‰¹åŒ–ãƒ‡ãƒ¼ã‚¿å–å¾—ã‚¯ãƒ©ã‚¹"""

    def __init__(self):
        self.currency_pair = "USD/JPY"
        self.yahoo_symbol = "USDJPY=X"
        self.fetch_interval = 300  # 5åˆ†é–“éš”
        self.retry_count = 3
        self.retry_delay = 2.0

    async def fetch_current_data(self) -> Optional[Dict[str, Any]]:
        """ç¾åœ¨ã®USD/JPYãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—"""
        try:
            ticker = yf.Ticker(self.yahoo_symbol)
            info = ticker.info

            if not info or "regularMarketPrice" not in info:
                return None

            return {
                "currency_pair": self.currency_pair,
                "timestamp": datetime.now(timezone.utc),
                "open_price": info.get("open", 0),
                "high_price": info.get("dayHigh", 0),
                "low_price": info.get("dayLow", 0),
                "close_price": info.get("regularMarketPrice", 0),
                "volume": info.get("volume", 0),
                "data_source": "Yahoo Finance"
            }

        except Exception as e:
            logger.error(f"USD/JPYãƒ‡ãƒ¼ã‚¿å–å¾—ã‚¨ãƒ©ãƒ¼: {e}")
            return None
```

#### å±¥æ­´ãƒ‡ãƒ¼ã‚¿å–å¾—

```python
async def fetch_historical_data(
    self,
    period: str = "5d",
    interval: str = "5m"
) -> Optional[pd.DataFrame]:
    """å±¥æ­´ãƒ‡ãƒ¼ã‚¿å–å¾—ï¼ˆãƒ†ã‚¯ãƒ‹ã‚«ãƒ«æŒ‡æ¨™è¨ˆç®—ç”¨ï¼‰"""
    try:
        ticker = yf.Ticker(self.yahoo_symbol)
        hist = ticker.history(period=period, interval=interval)

        if hist.empty:
            return None

        # ãƒ‡ãƒ¼ã‚¿æ­£è¦åŒ–
        hist = hist.reset_index()
        hist['currency_pair'] = self.currency_pair
        hist['data_source'] = "Yahoo Finance"

        return hist

    except Exception as e:
        logger.error(f"å±¥æ­´ãƒ‡ãƒ¼ã‚¿å–å¾—ã‚¨ãƒ©ãƒ¼: {e}")
        return None
```

### ğŸ§® **ãƒ†ã‚¯ãƒ‹ã‚«ãƒ«æŒ‡æ¨™è¨ˆç®—**

#### æŒ‡æ¨™è¨ˆç®—ã‚¯ãƒ©ã‚¹

```python
class TechnicalIndicatorCalculator:
    """ãƒ†ã‚¯ãƒ‹ã‚«ãƒ«æŒ‡æ¨™è¨ˆç®—ã‚¯ãƒ©ã‚¹"""

    def __init__(self):
        self.indicators = {
            'RSI': self.calculate_rsi,
            'MACD': self.calculate_macd,
            'BB': self.calculate_bollinger_bands,
            'SMA': self.calculate_sma,
            'EMA': self.calculate_ema
        }

    def calculate_rsi(self, prices: List[float], period: int = 14) -> float:
        """RSIè¨ˆç®—"""
        if len(prices) < period + 1:
            return None

        deltas = np.diff(prices)
        gains = np.where(deltas > 0, deltas, 0)
        losses = np.where(deltas < 0, -deltas, 0)

        avg_gain = np.mean(gains[-period:])
        avg_loss = np.mean(losses[-period:])

        if avg_loss == 0:
            return 100

        rs = avg_gain / avg_loss
        rsi = 100 - (100 / (1 + rs))

        return round(rsi, 2)

    def calculate_macd(
        self,
        prices: List[float],
        fast: int = 12,
        slow: int = 26,
        signal: int = 9
    ) -> Dict[str, float]:
        """MACDè¨ˆç®—"""
        if len(prices) < slow + signal:
            return None

        ema_fast = self.calculate_ema(prices, fast)
        ema_slow = self.calculate_ema(prices, slow)

        macd_line = ema_fast - ema_slow
        signal_line = self.calculate_ema([macd_line], signal)
        histogram = macd_line - signal_line

        return {
            "macd_line": round(macd_line, 6),
            "signal_line": round(signal_line, 6),
            "histogram": round(histogram, 6)
        }

    def calculate_bollinger_bands(
        self,
        prices: List[float],
        period: int = 20,
        std_dev: float = 2.0
    ) -> Dict[str, float]:
        """ãƒœãƒªãƒ³ã‚¸ãƒ£ãƒ¼ãƒãƒ³ãƒ‰è¨ˆç®—"""
        if len(prices) < period:
            return None

        sma = np.mean(prices[-period:])
        std = np.std(prices[-period:])

        upper_band = sma + (std_dev * std)
        lower_band = sma - (std_dev * std)

        return {
            "upper_band": round(upper_band, 5),
            "middle_band": round(sma, 5),
            "lower_band": round(lower_band, 5)
        }
```

### ğŸ”„ **ãƒ‡ãƒ¼ã‚¿å–å¾—ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©ãƒ¼**

#### ãƒ¡ã‚¤ãƒ³ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©ãƒ¼

```python
class USDJPYDataScheduler:
    """USD/JPYãƒ‡ãƒ¼ã‚¿å–å¾—ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©ãƒ¼"""

    def __init__(self):
        self.fetcher = USDJPYDataFetcher()
        self.calculator = TechnicalIndicatorCalculator()
        self.db_manager = DatabaseManager()
        self.pattern_analyzer = NotificationPatternAnalyzer()

        # è¨­å®š
        self.fetch_interval = 300  # 5åˆ†é–“éš”
        self.currency_pair = "USD/JPY"

    async def start_scheduler(self):
        """ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©ãƒ¼é–‹å§‹"""
        logger.info("USD/JPYãƒ‡ãƒ¼ã‚¿å–å¾—ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©ãƒ¼é–‹å§‹")

        while True:
            try:
                await self.fetch_and_process_data()
                await asyncio.sleep(self.fetch_interval)

            except KeyboardInterrupt:
                logger.info("ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©ãƒ¼åœæ­¢")
                break
            except Exception as e:
                logger.error(f"ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©ãƒ¼ã‚¨ãƒ©ãƒ¼: {e}")
                await asyncio.sleep(60)  # ã‚¨ãƒ©ãƒ¼æ™‚ã¯1åˆ†å¾…æ©Ÿ

    async def fetch_and_process_data(self):
        """ãƒ‡ãƒ¼ã‚¿å–å¾—ãƒ»å‡¦ç†ãƒ»ä¿å­˜"""
        start_time = time.time()

        try:
            # 1. ãƒ‡ãƒ¼ã‚¿å–å¾—
            price_data = await self.fetcher.fetch_current_data()
            if not price_data:
                logger.warning("ãƒ‡ãƒ¼ã‚¿å–å¾—å¤±æ•—")
                return

            # 2. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ä¿å­˜
            await self.db_manager.save_price_data(price_data)

            # 3. ãƒ†ã‚¯ãƒ‹ã‚«ãƒ«æŒ‡æ¨™è¨ˆç®—
            indicators = await self.calculate_indicators()
            if indicators:
                await self.db_manager.save_technical_indicators(indicators)

            # 4. ãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œå‡º
            patterns = await self.detect_patterns()
            if patterns:
                await self.db_manager.save_pattern_detections(patterns)
                await self.send_notifications(patterns)

            # 5. å±¥æ­´è¨˜éŒ²
            processing_time = (time.time() - start_time) * 1000
            await self.db_manager.save_fetch_history(
                success=True,
                response_time_ms=int(processing_time),
                data_count=1
            )

            logger.info(f"ãƒ‡ãƒ¼ã‚¿å‡¦ç†å®Œäº†: {processing_time:.2f}ms")

        except Exception as e:
            logger.error(f"ãƒ‡ãƒ¼ã‚¿å‡¦ç†ã‚¨ãƒ©ãƒ¼: {e}")
            await self.db_manager.save_fetch_history(
                success=False,
                error_message=str(e)
            )
```

## ğŸ”— æ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ çµ±åˆ

### ğŸ“Š **é€šçŸ¥ã‚·ã‚¹ãƒ†ãƒ çµ±åˆ**

#### ãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œå‡ºçµ±åˆ

```python
class DatabasePatternDetector:
    """ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ™ãƒ¼ã‚¹ã®ãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œå‡ºå™¨"""

    def __init__(self):
        self.analyzer = NotificationPatternAnalyzer()
        self.db_manager = DatabaseManager()

    async def detect_patterns_from_db(self) -> List[Dict[str, Any]]:
        """ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰æœ€æ–°ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã¦ãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œå‡º"""
        try:
            # æœ€æ–°ã®ä¾¡æ ¼ãƒ‡ãƒ¼ã‚¿å–å¾—
            price_data = await self.db_manager.get_latest_price_data(
                currency_pair="USD/JPY",
                limit=100  # ååˆ†ãªãƒ‡ãƒ¼ã‚¿é‡
            )

            # æœ€æ–°ã®ãƒ†ã‚¯ãƒ‹ã‚«ãƒ«æŒ‡æ¨™å–å¾—
            indicators = await self.db_manager.get_latest_indicators(
                currency_pair="USD/JPY",
                timeframe="M5"  # 5åˆ†è¶³
            )

            # ãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œå‡ºå®Ÿè¡Œ
            patterns = await self.analyzer.detect_all_patterns(
                price_data=price_data,
                indicators=indicators
            )

            return patterns

        except Exception as e:
            logger.error(f"ãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œå‡ºã‚¨ãƒ©ãƒ¼: {e}")
            return []
```

#### é€šçŸ¥é€ä¿¡çµ±åˆ

```python
class DatabaseNotificationManager:
    """ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ™ãƒ¼ã‚¹ã®é€šçŸ¥ç®¡ç†"""

    def __init__(self):
        self.discord_client = DiscordClient()
        self.db_manager = DatabaseManager()

    async def send_pattern_notifications(self, patterns: List[Dict[str, Any]]):
        """æ¤œå‡ºã•ã‚ŒãŸãƒ‘ã‚¿ãƒ¼ãƒ³ã®é€šçŸ¥é€ä¿¡"""
        for pattern in patterns:
            try:
                # é‡è¤‡ãƒã‚§ãƒƒã‚¯
                if await self.is_duplicate_notification(pattern):
                    continue

                # é€šçŸ¥ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆé¸æŠ
                template = self.get_notification_template(pattern['pattern_number'])

                # Discordé€šçŸ¥ä½œæˆ
                embed = template.create_embed(pattern)

                # é€šçŸ¥é€ä¿¡
                message_id = await self.discord_client.send_embed(embed)

                # é€šçŸ¥å±¥æ­´ä¿å­˜
                await self.db_manager.update_pattern_notification(
                    pattern_id=pattern['id'],
                    notification_sent=True,
                    discord_message_id=message_id
                )

                logger.info(f"ãƒ‘ã‚¿ãƒ¼ãƒ³{pattern['pattern_number']}é€šçŸ¥é€ä¿¡å®Œäº†")

            except Exception as e:
                logger.error(f"é€šçŸ¥é€ä¿¡ã‚¨ãƒ©ãƒ¼: {e}")

    async def is_duplicate_notification(self, pattern: Dict[str, Any]) -> bool:
        """é‡è¤‡é€šçŸ¥ãƒã‚§ãƒƒã‚¯"""
        # éå»1æ™‚é–“å†…ã®åŒã˜ãƒ‘ã‚¿ãƒ¼ãƒ³é€šçŸ¥ã‚’ãƒã‚§ãƒƒã‚¯
        recent_patterns = await self.db_manager.get_recent_patterns(
            pattern_number=pattern['pattern_number'],
            hours=1
        )

        return len(recent_patterns) > 0
```

### ğŸ”§ **è¨­å®šç®¡ç†çµ±åˆ**

#### å‹•çš„è¨­å®šç®¡ç†

```python
class DatabaseConfigManager:
    """ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ™ãƒ¼ã‚¹ã®è¨­å®šç®¡ç†"""

    def __init__(self):
        self.db_manager = DatabaseManager()
        self.cache = {}
        self.cache_ttl = 300  # 5åˆ†ã‚­ãƒ£ãƒƒã‚·ãƒ¥

    async def get_config(self, key: str, default=None):
        """è¨­å®šå€¤å–å¾—"""
        # ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒã‚§ãƒƒã‚¯
        if key in self.cache:
            cached_value, timestamp = self.cache[key]
            if time.time() - timestamp < self.cache_ttl:
                return cached_value

        # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰å–å¾—
        config = await self.db_manager.get_system_config(key)
        if config:
            value = self.parse_config_value(config['config_value'], config['config_type'])
            self.cache[key] = (value, time.time())
            return value

        return default

    async def set_config(self, key: str, value: Any, config_type: str = "string"):
        """è¨­å®šå€¤æ›´æ–°"""
        await self.db_manager.update_system_config(key, value, config_type)

        # ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ›´æ–°
        if key in self.cache:
            del self.cache[key]

    def parse_config_value(self, value: str, config_type: str) -> Any:
        """è¨­å®šå€¤ã®å‹å¤‰æ›"""
        if config_type == "integer":
            return int(value)
        elif config_type == "float":
            return float(value)
        elif config_type == "boolean":
            return value.lower() == "true"
        elif config_type == "json":
            return json.loads(value)
        else:
            return value
```

## ğŸ“Š ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

### âš¡ **API å‘¼ã³å‡ºã—æœ€é©åŒ–**

#### å‘¼ã³å‡ºã—å›æ•°å‰Šæ¸›

```python
class OptimizedDataFetcher:
    """æœ€é©åŒ–ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿å–å¾—ã‚¯ãƒ©ã‚¹"""

    def __init__(self):
        self.fetcher = USDJPYDataFetcher()
        self.cache = {}
        self.cache_ttl = 300  # 5åˆ†ã‚­ãƒ£ãƒƒã‚·ãƒ¥

    async def get_optimized_data(self) -> Optional[Dict[str, Any]]:
        """æœ€é©åŒ–ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿å–å¾—"""
        current_time = time.time()

        # ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒã‚§ãƒƒã‚¯
        if 'last_fetch' in self.cache:
            last_fetch_time, last_data = self.cache['last_fetch']
            if current_time - last_fetch_time < self.cache_ttl:
                return last_data

        # æ–°è¦ãƒ‡ãƒ¼ã‚¿å–å¾—
        data = await self.fetcher.fetch_current_data()
        if data:
            self.cache['last_fetch'] = (current_time, data)

        return data
```

#### ãƒãƒƒãƒå‡¦ç†

```python
class BatchDataProcessor:
    """ãƒãƒƒãƒãƒ‡ãƒ¼ã‚¿å‡¦ç†ã‚¯ãƒ©ã‚¹"""

    def __init__(self):
        self.db_manager = DatabaseManager()
        self.batch_size = 100
        self.batch_timeout = 60  # 60ç§’ã§ãƒãƒƒãƒå‡¦ç†

    async def process_batch(self, data_batch: List[Dict[str, Any]]):
        """ãƒãƒƒãƒãƒ‡ãƒ¼ã‚¿å‡¦ç†"""
        if len(data_batch) >= self.batch_size:
            await self.save_batch_data(data_batch)
            return []
        return data_batch

    async def save_batch_data(self, data_batch: List[Dict[str, Any]]):
        """ãƒãƒƒãƒãƒ‡ãƒ¼ã‚¿ä¿å­˜"""
        try:
            # ä¸€æ‹¬æŒ¿å…¥
            await self.db_manager.bulk_insert_price_data(data_batch)
            logger.info(f"ãƒãƒƒãƒä¿å­˜å®Œäº†: {len(data_batch)}ä»¶")
        except Exception as e:
            logger.error(f"ãƒãƒƒãƒä¿å­˜ã‚¨ãƒ©ãƒ¼: {e}")
```

### ğŸ—„ï¸ **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æœ€é©åŒ–**

#### ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹æœ€é©åŒ–

```sql
-- è¤‡åˆã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ä½œæˆ
CREATE INDEX CONCURRENTLY idx_price_data_currency_timestamp_composite
ON price_data (currency_pair, timestamp DESC);

CREATE INDEX CONCURRENTLY idx_tech_indicators_composite
ON technical_indicators (currency_pair, indicator_type, timestamp DESC);

CREATE INDEX CONCURRENTLY idx_pattern_detections_composite
ON pattern_detections (currency_pair, pattern_number, detection_time DESC);
```

#### ã‚¯ã‚¨ãƒªæœ€é©åŒ–

```python
class OptimizedDatabaseQueries:
    """æœ€é©åŒ–ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¯ã‚¨ãƒª"""

    async def get_latest_data_optimized(self, limit: int = 100) -> List[Dict[str, Any]]:
        """æœ€é©åŒ–ã•ã‚ŒãŸæœ€æ–°ãƒ‡ãƒ¼ã‚¿å–å¾—"""
        query = """
        SELECT pd.*, ti.indicator_type, ti.value, ti.additional_data
        FROM price_data pd
        LEFT JOIN technical_indicators ti
            ON pd.currency_pair = ti.currency_pair
            AND pd.timestamp = ti.timestamp
        WHERE pd.currency_pair = 'USD/JPY'
        ORDER BY pd.timestamp DESC
        LIMIT :limit
        """

        return await self.db_manager.execute_query(query, {"limit": limit})

    async def get_pattern_statistics(self, days: int = 7) -> Dict[str, Any]:
        """ãƒ‘ã‚¿ãƒ¼ãƒ³çµ±è¨ˆå–å¾—"""
        query = """
        SELECT
            pattern_number,
            pattern_name,
            COUNT(*) as detection_count,
            AVG(confidence_score) as avg_confidence,
            MAX(detection_time) as last_detection
        FROM pattern_detections
        WHERE detection_time >= NOW() - INTERVAL ':days days'
        GROUP BY pattern_number, pattern_name
        ORDER BY detection_count DESC
        """

        return await self.db_manager.execute_query(query, {"days": days})
```

## ğŸ”§ å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ

### ğŸ“ **æ–°è¦ä½œæˆãƒ•ã‚¡ã‚¤ãƒ«**

```
src/infrastructure/database/
â”œâ”€â”€ models/
â”‚   â”œâ”€â”€ price_data_model.py          # ä¾¡æ ¼ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«
â”‚   â”œâ”€â”€ technical_indicator_model.py # ãƒ†ã‚¯ãƒ‹ã‚«ãƒ«æŒ‡æ¨™ãƒ¢ãƒ‡ãƒ«
â”‚   â”œâ”€â”€ pattern_detection_model.py   # ãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œå‡ºãƒ¢ãƒ‡ãƒ«
â”‚   â”œâ”€â”€ data_fetch_history_model.py  # ãƒ‡ãƒ¼ã‚¿å–å¾—å±¥æ­´ãƒ¢ãƒ‡ãƒ«
â”‚   â””â”€â”€ system_config_model.py       # ã‚·ã‚¹ãƒ†ãƒ è¨­å®šãƒ¢ãƒ‡ãƒ«
â”œâ”€â”€ repositories/
â”‚   â”œâ”€â”€ price_data_repository.py     # ä¾¡æ ¼ãƒ‡ãƒ¼ã‚¿ãƒªãƒã‚¸ãƒˆãƒª
â”‚   â”œâ”€â”€ technical_indicator_repository.py # ãƒ†ã‚¯ãƒ‹ã‚«ãƒ«æŒ‡æ¨™ãƒªãƒã‚¸ãƒˆãƒª
â”‚   â”œâ”€â”€ pattern_detection_repository.py   # ãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œå‡ºãƒªãƒã‚¸ãƒˆãƒª
â”‚   â””â”€â”€ system_config_repository.py  # ã‚·ã‚¹ãƒ†ãƒ è¨­å®šãƒªãƒã‚¸ãƒˆãƒª
â””â”€â”€ services/
    â”œâ”€â”€ data_fetcher_service.py      # ãƒ‡ãƒ¼ã‚¿å–å¾—ã‚µãƒ¼ãƒ“ã‚¹
    â”œâ”€â”€ technical_indicator_service.py # ãƒ†ã‚¯ãƒ‹ã‚«ãƒ«æŒ‡æ¨™ã‚µãƒ¼ãƒ“ã‚¹
    â””â”€â”€ pattern_detection_service.py # ãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œå‡ºã‚µãƒ¼ãƒ“ã‚¹

src/infrastructure/scheduler/
â”œâ”€â”€ usdjpy_data_scheduler.py         # USD/JPYãƒ‡ãƒ¼ã‚¿å–å¾—ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©ãƒ¼
â”œâ”€â”€ technical_indicator_scheduler.py # ãƒ†ã‚¯ãƒ‹ã‚«ãƒ«æŒ‡æ¨™è¨ˆç®—ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©ãƒ¼
â””â”€â”€ pattern_detection_scheduler.py   # ãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œå‡ºã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©ãƒ¼

scripts/cron/
â”œâ”€â”€ usdjpy_data_cron.py              # USD/JPYãƒ‡ãƒ¼ã‚¿å–å¾—cron
â””â”€â”€ technical_analysis_cron.py       # ãƒ†ã‚¯ãƒ‹ã‚«ãƒ«åˆ†æcron

tests/
â”œâ”€â”€ database/
â”‚   â”œâ”€â”€ test_price_data_model.py     # ä¾¡æ ¼ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«ãƒ†ã‚¹ãƒˆ
â”‚   â”œâ”€â”€ test_technical_indicator_model.py # ãƒ†ã‚¯ãƒ‹ã‚«ãƒ«æŒ‡æ¨™ãƒ¢ãƒ‡ãƒ«ãƒ†ã‚¹ãƒˆ
â”‚   â””â”€â”€ test_pattern_detection_model.py   # ãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œå‡ºãƒ¢ãƒ‡ãƒ«ãƒ†ã‚¹ãƒˆ
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ test_data_fetcher_service.py # ãƒ‡ãƒ¼ã‚¿å–å¾—ã‚µãƒ¼ãƒ“ã‚¹ãƒ†ã‚¹ãƒˆ
â”‚   â””â”€â”€ test_technical_indicator_service.py # ãƒ†ã‚¯ãƒ‹ã‚«ãƒ«æŒ‡æ¨™ã‚µãƒ¼ãƒ“ã‚¹ãƒ†ã‚¹ãƒˆ
â””â”€â”€ integration/
    â””â”€â”€ test_database_integration.py # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹çµ±åˆãƒ†ã‚¹ãƒˆ
```

### ğŸ”„ **æ—¢å­˜ãƒ•ã‚¡ã‚¤ãƒ«ä¿®æ­£**

```
src/infrastructure/
â”œâ”€â”€ analysis/
â”‚   â””â”€â”€ notification_pattern_analyzer.py  # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹çµ±åˆå¯¾å¿œ
â”œâ”€â”€ messaging/
â”‚   â””â”€â”€ notification_manager.py           # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹é€šçŸ¥å¯¾å¿œ
â””â”€â”€ external_apis/
    â””â”€â”€ yahoo_finance_client.py           # USD/JPYç‰¹åŒ–å¯¾å¿œ

scripts/cron/
â”œâ”€â”€ integrated_ai_discord.py              # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹çµ±åˆå¯¾å¿œ
â””â”€â”€ real_ai_discord_v2.py                 # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹çµ±åˆå¯¾å¿œ
```

## ğŸ“… å®Ÿè£…ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«

### ğŸ—“ï¸ **Phase 1: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹åŸºç›¤ï¼ˆ1 é€±é–“ï¼‰**

#### Day 1-2: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ¢ãƒ‡ãƒ«å®Ÿè£…

- [ ] `price_data_model.py` ä½œæˆ
- [ ] `technical_indicator_model.py` ä½œæˆ
- [ ] `pattern_detection_model.py` ä½œæˆ
- [ ] `data_fetch_history_model.py` ä½œæˆ
- [ ] `system_config_model.py` ä½œæˆ

#### Day 3-4: ãƒªãƒã‚¸ãƒˆãƒªå®Ÿè£…

- [ ] `price_data_repository.py` ä½œæˆ
- [ ] `technical_indicator_repository.py` ä½œæˆ
- [ ] `pattern_detection_repository.py` ä½œæˆ
- [ ] `system_config_repository.py` ä½œæˆ

#### Day 5-7: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ†ã‚¹ãƒˆ

- [ ] ãƒ¢ãƒ‡ãƒ«å˜ä½“ãƒ†ã‚¹ãƒˆ
- [ ] ãƒªãƒã‚¸ãƒˆãƒªå˜ä½“ãƒ†ã‚¹ãƒˆ
- [ ] ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹çµ±åˆãƒ†ã‚¹ãƒˆ

### ğŸ—“ï¸ **Phase 2: ãƒ‡ãƒ¼ã‚¿å–å¾—ã‚·ã‚¹ãƒ†ãƒ ï¼ˆ1 é€±é–“ï¼‰**

#### Day 1-3: ãƒ‡ãƒ¼ã‚¿å–å¾—ã‚µãƒ¼ãƒ“ã‚¹å®Ÿè£…

- [ ] `data_fetcher_service.py` ä½œæˆ
- [ ] `technical_indicator_service.py` ä½œæˆ
- [ ] Yahoo Finance API çµ±åˆ
- [ ] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°å®Ÿè£…

#### Day 4-5: ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©ãƒ¼å®Ÿè£…

- [ ] `usdjpy_data_scheduler.py` ä½œæˆ
- [ ] `technical_indicator_scheduler.py` ä½œæˆ
- [ ] 5 åˆ†é–“éš”å®Ÿè¡Œè¨­å®š

#### Day 6-7: ãƒ†ã‚¹ãƒˆãƒ»æœ€é©åŒ–

- [ ] ãƒ‡ãƒ¼ã‚¿å–å¾—ãƒ†ã‚¹ãƒˆ
- [ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–
- [ ] ã‚¨ãƒ©ãƒ¼å‡¦ç†ãƒ†ã‚¹ãƒˆ

### ğŸ—“ï¸ **Phase 3: é€šçŸ¥ã‚·ã‚¹ãƒ†ãƒ çµ±åˆï¼ˆ1 é€±é–“ï¼‰**

#### Day 1-3: ãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œå‡ºçµ±åˆ

- [ ] `pattern_detection_service.py` ä½œæˆ
- [ ] æ—¢å­˜ãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œå‡ºå™¨çµ±åˆ
- [ ] ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ™ãƒ¼ã‚¹æ¤œå‡ºå®Ÿè£…

#### Day 4-5: é€šçŸ¥ç®¡ç†çµ±åˆ

- [ ] ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹é€šçŸ¥ç®¡ç†å®Ÿè£…
- [ ] é‡è¤‡é€šçŸ¥é˜²æ­¢æ©Ÿèƒ½
- [ ] é€šçŸ¥å±¥æ­´ç®¡ç†

#### Day 6-7: çµ±åˆãƒ†ã‚¹ãƒˆ

- [ ] ã‚¨ãƒ³ãƒ‰ãƒ„ãƒ¼ã‚¨ãƒ³ãƒ‰ãƒ†ã‚¹ãƒˆ
- [ ] é€šçŸ¥ç²¾åº¦ãƒ†ã‚¹ãƒˆ
- [ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ

### ğŸ—“ï¸ **Phase 4: æœ¬ç•ªé‹ç”¨æº–å‚™ï¼ˆ1 é€±é–“ï¼‰**

#### Day 1-3: cron è¨­å®šãƒ»ç›£è¦–

- [ ] `usdjpy_data_cron.py` ä½œæˆ
- [ ] `technical_analysis_cron.py` ä½œæˆ
- [ ] ç›£è¦–ã‚·ã‚¹ãƒ†ãƒ å®Ÿè£…

#### Day 4-5: è¨­å®šç®¡ç†ãƒ»æœ€é©åŒ–

- [ ] å‹•çš„è¨­å®šç®¡ç†å®Ÿè£…
- [ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–
- [ ] ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—æ©Ÿèƒ½

#### Day 6-7: æœ¬ç•ªãƒ‡ãƒ—ãƒ­ã‚¤

- [ ] æœ¬ç•ªç’°å¢ƒè¨­å®š
- [ ] ãƒ‡ãƒ¼ã‚¿ç§»è¡Œ
- [ ] é‹ç”¨é–‹å§‹

## ğŸ“Š æœŸå¾…åŠ¹æœ

### ğŸ¯ **API å‘¼ã³å‡ºã—å‰Šæ¸›**

- **ç¾åœ¨**: 171 å›/æ—¥ï¼ˆè¤‡æ•°é€šè²¨ãƒšã‚¢ï¼‰
- **å®Ÿè£…å¾Œ**: 288 å›/æ—¥ï¼ˆUSD/JPY ã®ã¿ï¼‰
- **å‰Šæ¸›ç‡**: 0%ï¼ˆé€šè²¨ãƒšã‚¢å‰Šæ¸›ã«ã‚ˆã‚‹åŠ¹æœï¼‰

### âš¡ **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å‘ä¸Š**

- **ãƒ‡ãƒ¼ã‚¿å–å¾—æ™‚é–“**: 3-5 ç§’ â†’ 1-2 ç§’
- **åˆ†æå‡¦ç†æ™‚é–“**: 10-15 ç§’ â†’ 5-8 ç§’
- **é€šçŸ¥é€ä¿¡æ™‚é–“**: 3-5 ç§’ â†’ 1-2 ç§’

### ğŸ“ˆ **ãƒ‡ãƒ¼ã‚¿å“è³ªå‘ä¸Š**

- **ãƒ‡ãƒ¼ã‚¿å–å¾—æˆåŠŸç‡**: 85% â†’ 95%
- **ã‚¨ãƒ©ãƒ¼ç‡**: 15% â†’ 5%
- **ãƒ‡ãƒ¼ã‚¿å®Œå…¨æ€§**: 90% â†’ 98%

### ğŸ”„ **é‹ç”¨åŠ¹ç‡å‘ä¸Š**

- **è‡ªå‹•åŒ–ç‡**: 70% â†’ 95%
- **ç›£è¦–ç²¾åº¦**: 80% â†’ 95%
- **ä¿å®ˆæ€§**: ä¸­ â†’ é«˜

## ğŸš€ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

### ğŸ“‹ **å®Ÿè£…é–‹å§‹å‰ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ**

- [ ] ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ç’°å¢ƒç¢ºèª
- [ ] Yahoo Finance API æ¥ç¶šãƒ†ã‚¹ãƒˆ
- [ ] æ—¢å­˜é€šçŸ¥ã‚·ã‚¹ãƒ†ãƒ å‹•ä½œç¢ºèª
- [ ] é–‹ç™ºç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

### ğŸ”§ **å®Ÿè£…é–‹å§‹**

1. **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ¢ãƒ‡ãƒ«å®Ÿè£…**ã‹ã‚‰é–‹å§‹
2. **æ®µéšçš„çµ±åˆ**ã«ã‚ˆã‚‹ãƒªã‚¹ã‚¯æœ€å°åŒ–
3. **ç¶™ç¶šçš„ãƒ†ã‚¹ãƒˆ**ã«ã‚ˆã‚‹å“è³ªä¿è¨¼
4. **æœ¬ç•ªé‹ç”¨**ã¸ã®æ®µéšçš„ç§»è¡Œ

---

**ğŸ¯ ã“ã®è¨­è¨ˆæ›¸ã«åŸºã¥ã„ã¦ã€USD/JPY ç‰¹åŒ–ã® 5 åˆ†ãŠããƒ‡ãƒ¼ã‚¿å–å¾—ã‚·ã‚¹ãƒ†ãƒ ã‚’å®Ÿè£…ã—ã€æ—¢å­˜ã®é€šçŸ¥ã‚·ã‚¹ãƒ†ãƒ ã¨å®Œå…¨çµ±åˆã—ã¾ã™ã€‚**
